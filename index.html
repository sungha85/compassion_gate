<!DOCTYPE html>
<html lang="ko" dir="ltr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="color-scheme" content="light" />
<title>ì‚¬ë‚´ í¬í„¸ â€“ ë°”ë¡œê°€ê¸° + ì „ì‚¬ì¼ì •</title>
<style>
  :root{
    --bg:#f6f7f9; --folder:#ffffff; --line:rgba(0,0,0,.06); --card:#fff; --grid:#e5e7eb; --text:#0f172a;
    --focus:#2563eb; --muted:#64748b; --shadow:0 12px 24px rgba(0,0,0,.06);
    --lane-h:64px; --lane-gap:1px; --left-col:160px; --header-h:34px; --cell-pad:8px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:24px; font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif; background:var(--bg); color:var(--text)}
  img{max-width:100%; display:block}
  a{color:inherit; text-decoration:none}
  a:focus-visible,button:focus-visible{outline:3px solid var(--focus); outline-offset:3px; border-radius:8px}
  .visually-hidden{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0}

  h1{margin:0 0 20px; font-size:18px}
  h2{margin:28px 0 12px; font-size:16px}
  .container{max-width:1200px; margin:0 auto}
  .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:24px}

  /* í´ë” ì¹´ë“œ (ë°”ë¡œê°€ê¸°) */
  .folder{background:var(--folder);border-radius:28px;padding:18px 16px;border:1px solid var(--line);
          box-shadow:var(--shadow), inset 0 1px 0 rgba(255,255,255,.7); transition:transform .15s, box-shadow .15s}
  .folder:hover{ transform:translateY(-2px); box-shadow:0 16px 30px rgba(0,0,0,.08), inset 0 1px 0 rgba(255,255,255,.7) }
  .apps{display:grid; grid-template-columns:repeat(3,1fr); gap:10px}
  .app{display:flex; align-items:center; justify-content:center; flex-direction:column; color:var(--text); gap:6px; min-height:92px}
  .badge{width:58px;height:58px;border-radius:16px;display:flex;align-items:center;justify-content:center;box-shadow:inset 0 1px 0 rgba(255,255,255,.25), 0 6px 14px rgba(0,0,0,.08);transition:transform .12s, box-shadow .12s; font-weight:700; font-size:12px; color:#fff}
  .app:hover .badge{ transform:translateY(-1px); box-shadow:inset 0 1px 0 rgba(255,255,255,.25), 0 10px 18px rgba(0,0,0,.12) }
  .label{font-size:10px;color:#334155;text-align:center;max-width:84px;line-height:1.2}
  .c-red{background:linear-gradient(135deg,#ff6a7a,#ff3d3d)}
  .c-purple{background:linear-gradient(135deg,#a77bff,#7a4cff)}
  .c-sky{background:linear-gradient(135deg,#79b6ff,#4a8dff)}
  .c-orange{background:linear-gradient(135deg,#ffa552,#ff7a1a)}
  .c-green{background:linear-gradient(135deg,#55d6a9,#26b87a)}
  .c-blue{background:linear-gradient(135deg,#6e8cff,#3b5bff)}
  .c-teal{background:linear-gradient(135deg,#64e0e3,#28c3d6)}
  .c-gray{background:linear-gradient(135deg,#c9ced6,#9aa3ad)}
  .folder-label{display:flex;align-items:center;justify-content:center;gap:6px;margin-top:8px;font-size:14px}
  .folder-label .emoji{display:none !important;} /* ì´ëª¨ì§€ ì œê±° */

  /* ë²„íŠ¼/ì»¨íŠ¸ë¡¤ ê³µí†µ */
  .btn{border:1px solid var(--grid);background:#fff;border-radius:10px;padding:8px 12px;font-size:13px;cursor:pointer}
  .btn.ghost{background:#fafafa}
  .btn.primary{background:#2563eb;color:#fff;border-color:#2563eb}
  .btn[aria-pressed="true"]{box-shadow:inset 0 0 0 2px #2563eb33}

  /* ==== ì œëª© ë¼ì¸ë§Œ í•˜ì´ë¼ì´íŠ¸ ==== */
  .title-strip{
    display:flex; align-items:center; justify-content:space-between;
    padding:20px 18px; margin:0 0 14px; border-radius:14px; color:#fff;
    box-shadow:0 8px 20px rgba(17,38,94,.18);
    background:linear-gradient(135deg,#2a5eec,#6a8ef2);
  }
  .title-strip .btn.ghost{background:rgba(255,255,255,.16); color:#fff; border-color:transparent}
  .title-strip .btn.ghost:hover{background:rgba(255,255,255,.24)}

  /* ìº˜ë¦°ë” ìƒë‹¨ (Hero) */
  .sp-hero{margin:28px 0 8px}
  .sp-titlebar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:6px}
  .sp-titlebar h2{margin:0;font-size:22px}
  .sp-sub{margin:6px 0 0;color:#64748b;font-size:13px}

  /* ì¼ì • ì»¨íŠ¸ë¡¤ ë°”(ì—°/ì›”) */
  .cal-controls{display:flex;gap:8px;align-items:center;margin:10px 0 6px;flex-wrap:wrap}
  .cal-controls .seg{display:inline-flex;border:1px solid var(--grid);border-radius:10px;overflow:hidden}
  .cal-controls .seg button{padding:6px 10px;border:0;background:#fff;font-size:12px;cursor:pointer}
  .cal-controls .seg button[aria-pressed="true"]{background:#eef2ff}
  .cal-controls select{border:1px solid var(--grid);border-radius:10px;padding:6px 10px;background:#fff}

  /* ì¹´ë“œ */
  .card{background:var(--card);border:1px solid var(--grid);border-radius:14px;box-shadow:0 2px 6px rgba(0,0,0,.04)}

  /* ë§¤íŠ¸ë¦­ìŠ¤ */
  .year-grid{position:relative;overflow:hidden}
  .header,.row{display:grid}
  .header div,.row div{padding:var(--cell-pad);border-bottom:1px solid var(--grid)}
  .header{background:#f7f8fa;font-size:12px;font-weight:600;position:sticky;top:0;z-index:2}
  .lane-name{padding:10px 12px;border-right:1px solid var(--grid);display:flex;align-items:center;font-size:12px;font-weight:600;background:#f9fafb;color:#111827}
  .cell{height:var(--lane-h);border-left:1px solid var(--grid)}
  .row .cell:first-child{border-left:none}
  .grid-lines{position:absolute;pointer-events:none}
  .grid-lines div{border-left:1px dashed #e6e6e6}
  .bar-layer{position:absolute}
  .event{position:absolute;height:26px;border-radius:8px;padding:4px 8px;font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:pointer;box-shadow:0 1px 3px rgba(0,0,0,.08);border:1px solid rgba(0,0,0,.05);font-weight:600}
  .today-line{position:absolute;top:var(--header-h);bottom:0;width:2px;background:#2563eb33;pointer-events:none}

  /* ë ˆì¸ ìƒ‰ìƒ */
  .t-ëŒ€í‘œì‹¤{background:#e0f2fe}
  .t-ì»´í”Œ{background:#e8f7ff}
  .t-ì „ëµ{background:#d1fae5}
  .t-ì¬ê²½{background:#fef9c3}
  .t-P\&C{background:#fee2e2}  /* P&C ì´ìŠ¤ì¼€ì´í”„ */
  .t-ë¯¸ì…˜{background:#f5e8ff}
  .t-êµíŒŒ{background:#e7fff2}
  .t-êµë¯¸{background:#fff0e5}
  .t-ë¹„ì „{background:#ffe7fb}
  .t-ë¬´ë¸Œ{background:#e0e7ff}
  .t-ë””ì´{background:#f0f7e9}
  .t-ë§ˆìº {background:#e9f6ff}
  .t-ë¸Œì»´{background:#fce9ff}
  .t-í¬ë¦¬{background:#fff3e9}
  .t-íŠ¹í›„{background:#e9fffb}
  .t-IT{background:#e5e7eb}
  .t-SE{background:#f2f2ff}
  .t-SR{background:#f9f2ff}

  @media (prefers-reduced-motion: reduce){ .folder,.badge{transition:none} }
  @media print{
    body{margin:0}
    .grid,.imgbox,.hint,h1,.controls,.sp-hero,.cal-controls{display:none}
    .year-grid{border:0}
  }
/* ===== Tooltip (ê°œì„  ë²„ì „) ===== */
.tooltip{
  position: fixed;
  z-index: 9999;
  max-width: 240px;             /* ê³ ì • ìµœëŒ€í­ */
  padding: 10px 12px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 10px;
  background: #fff;
  color: #111827;
  border: 1px solid #e5e7eb;
  box-shadow: 0 10px 24px rgba(0,0,0,.16);
  pointer-events: none;
  opacity: 0;
  transform: translateY(-6px) scale(.98);
  transition: opacity .14s ease, transform .14s ease;

  /* ê¸¸ê²Œ ëŠ˜ì–´ì§€ì§€ ì•Šë„ë¡ */
  white-space: normal;
  word-break: keep-all;          /* í•œê¸€ ë‹¨ì–´ ìœ ì§€ */
  overflow-wrap: anywhere;       /* ê¸´ URL ê°™ì€ ê±´ ì¤„ë°”ê¿ˆ */
  text-align: left;
}

/* ë³´ì´ê¸° */
.tooltip[data-show="true"]{
  opacity: 1;
  transform: translateY(0) scale(1);
}

/* í™”ì‚´í‘œ */
.tooltip::after{
  content:"";
  position:absolute;
  left:50%;
  transform: translateX(-50%);
  border:6px solid transparent;
  filter: drop-shadow(0 2px 2px rgba(0,0,0,.08));
}

/* ìœ„ìª½ ë°°ì¹˜(ê¸°ë³¸) â€” í™”ì‚´í‘œê°€ ì•„ë˜ë¥¼ í–¥í•¨ */
.tooltip[data-pos="top"]::after{
  bottom:-12px;
  border-top-color:#fff;
}

/* ì•„ë˜ìª½ ë°°ì¹˜ â€” í™”ì‚´í‘œê°€ ìœ„ë¥¼ í–¥í•¨ */
.tooltip[data-pos="bottom"]::after{
  top:-12px;
  border-bottom-color:#fff;
}

  /* === ì¹´ë“œ ë†’ì´ í†µì¼: grid-item(section)ì™€ .folderë¥¼ ëŠ˜ë ¤ì„œ ë§ì¶¤ === */
.grid > section{ display:flex; flex-direction:column; height:100%; }
.grid > section .folder{ display:flex; flex-direction:column; height:100%; }
.grid > section .apps{ flex:1 1 auto; }           /* ì•„ì´ì½˜ ì˜ì—­ì´ ë‚¨ëŠ” ë†’ì´ë¥¼ ì°¨ì§€ */

/* (ì„ íƒ) ì•„ì´ì½˜ ê·¸ë¦¬ë“œê°€ í•­ìƒ ê³ ë¥´ê²Œ ë³´ì´ê²Œ */
.grid > section .apps{ display:grid; grid-template-columns:repeat(3,1fr); gap:10px; }

/* (ì„ íƒ) â€œëª¨~ë“  ì¹´ë“œ ë†’ì´ë¥¼ ì™„ì „íˆ ë™ì¼â€í•˜ê²Œ ê°•ì œí•˜ê³  ì‹¶ë‹¤ë©´ ê°’ í•˜ë‚˜ë¡œ í†µì¼ */
.grid > section .folder{ min-height:260px; }       /* â‘¤ ì¹´ë“œ ê³µí†µ ìµœì†Œë†’ì´(ì›í•˜ë©´ ìˆ«ì ì¡°ì ˆ) */

  /* === ì¹´ë“œ ë†’ì´ í†µì¼ + ë”ë³´ê¸° ì¹© === */
.grid > section{display:flex;flex-direction:column;height:100%}
.grid > section .folder{display:flex;flex-direction:column;height:100%;min-height:280px}
.grid > section .apps{flex:1 1 auto}

/* +N ë”ë³´ê¸° ì¹© */
.more-chip{
  display:flex;align-items:center;justify-content:center;
  gap:6px;height:92px;border-radius:16px;border:1px dashed #dbe1e8;
  background:#f8fafc;color:#334155;cursor:pointer;font-size:12px;font-weight:700;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.6);
}
.more-chip:hover{background:#f1f5f9}

/* ëª¨ë‹¬(ë”ë³´ê¸°) */
#more-modal[aria-hidden="true"]{display:none}
#more-modal{
  position:fixed;inset:0;z-index:70;display:flex;align-items:center;justify-content:center;
  padding:20px;background:rgba(0,0,0,.45)
}
.more-box{
  background:#fff;border:1px solid var(--grid);border-radius:14px;max-width:780px;width:100%;
  padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.15)
}
.more-title{margin:0 0 10px;font-size:16px}
.more-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:14px}
.more-app{
  display:flex;flex-direction:column;align-items:center;gap:8px;padding:12px;border:1px solid #eef2f6;
  border-radius:12px;background:#fafafa
}
.more-app .badge{transform:none} /* ëª¨ë‹¬ ì•ˆì—ì„  ì í”„ íš¨ê³¼ ì œê±° */
.more-footer{display:flex;gap:8px;justify-content:flex-end;margin-top:14px}

/* === 6ì¹¸ ê³ ì • ìŠ¬ë¡¯(3x2) + ë°˜ì‘í˜• === */
.grid > section{display:flex;flex-direction:column;height:100%}
.grid > section .folder{display:flex;flex-direction:column;height:100%;min-height:280px}
.grid > section .apps{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
}
@media (max-width: 900px){ .grid > section .apps{ grid-template-columns:repeat(2,1fr);} }
@media (max-width: 520px){ .grid > section .apps{ grid-template-columns:1fr;} }

/* ìŠ¬ë¡¯: ì•±/ë”ë³´ê¸°/ë¹ˆì¹¸ ëª¨ë‘ ê°™ì€ ë†’ì´ë¡œ */
.app, .more-tile, .slot-empty{
  display:flex;align-items:center;justify-content:center;flex-direction:column;gap:6px;min-height:92px;
}

/* ë”ë³´ê¸° íƒ€ì¼(ì•±ê³¼ ë™ì¼ ì‚¬ì´ì¦ˆë¡œ í‘œì‹œ) */
.more-tile{
  border-radius:16px;border:1px dashed #dbe1e8;background:#f8fafc;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.6);
  cursor:pointer;font-weight:700;
}
.more-tile:hover{background:#f1f5f9}

/* ë¹ˆ ìŠ¬ë¡¯(ìë¦¬ë§Œ ì°¨ì§€í•˜ê³  ë³´ì´ì§€ ì•ŠìŒ) */
.slot-empty{ visibility:hidden; }
/* === ëª¨ë‹¬ í‘œì‹œ ë³´ê°• === */
#more-modal { display: flex; z-index:9999; }                     /* ê¸°ë³¸ í‘œì‹œë¥¼ flexë¡œ (ì•ˆë³´ì´ëŠ” ë¬¸ì œ ë°©ì§€) */
#more-modal[aria-hidden="true"] { display: none; } /* ë‹«ì„ ë•Œë§Œ ìˆ¨ê¸°ê¸° */
  
</style>
</head>
<body>
<div class="container" role="main">

  <!-- ì œëª© í•œ ì¤„ í•˜ì´ë¼ì´íŠ¸ -->
  <h1 class="title-strip">
    <span>ì»´íŒ¨ì…˜ ì¦ê²¨ì°¾ê¸°</span>
    <button id="app-links-btn" class="btn ghost" type="button">ì•± ë§í¬</button>
  </h1>

  <!-- ====================== ë°”ë¡œê°€ê¸° (Quick Links) ====================== -->
  <div class="grid" id="quick-grid">
    <!-- ğŸ¬ í˜„í™© -->
    <section aria-labelledby="sec-Dashboard">
      <div class="folder" role="group" aria-labelledby="sec-Dashboard">
        <div class="apps">
          <a class="app" data-key="CDSP" href="https://compassionkorea.lightning.force.com/lightning/r/Dashboard/01Z2x00000086p2EAA/view?queryScope=userFolders" target="_blank" rel="noopener noreferrer"><div class="badge c-purple">CDSP</div><div class="label">CDSP</div></a>
          <a class="app" data-key="KRI" href="https://compassionkorea.lightning.force.com/lightning/r/Dashboard/01Z2x000000QEwMEAW/view" target="_blank" rel="noopener noreferrer"><div class="badge c-red">KRI</div><div class="label">KRI</div></a>
          <a class="app" data-key="LE" href="https://compassionkorea.sharepoint.com/:x:/s/maketing/EXVOhXaIRMNBvzScNMHEycMBXkXIgNO1UNBRMcdAStnOWQ?e=4EfFYq" target="_blank" rel="noopener noreferrer"><div class="badge c-blue">LE</div><div class="label">LE</div></a>
          <a class="app" data-key="Scorecard" href="https://one.compassion.com/sites/finance/SitePageModern/194296/global-scorecard" target="_blank" rel="noopener noreferrer"><div class="badge c-green">GS</div><div class="label">Global Scorecard</div></a>
          <span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-dashboard"><span>í˜„í™©</span></div>
    </section>

    <!-- â¤ï¸ P&C -->
    <section aria-labelledby="sec-pc">
      <div class="folder" role="group" aria-labelledby="sec-pc">
        <div class="apps">
<!-- ì¸ì‚¬ê·¼íƒœ -->
      <a class="app"
         data-key="ì¸ì‚¬ê·¼íƒœ"
         href="http://gwa.compassion.or.kr/gw/bizbox.do"
         target="_blank"
         rel="noopener noreferrer"
         data-tooltip="ì¶œí‡´ê·¼, ì—°ì°¨ ë“± ê·¼íƒœë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.">
        <div class="badge c-red"><span aria-hidden="true">ê·¼íƒœ</span></div>
        <div class="label">ì¸ì‚¬ê·¼íƒœ</div>
      </a>

      <!-- ì¡°ì§ë„ -->
      <a class="app"
         data-key="ì¡°ì§ë„"
         href="https://compassionkorea.sharepoint.com/:b:/s/share/EVwEjJlrN2JGs9_tak31NVABfFJgdYNMhtQGLq0ArpJZNA?e=HZ27fL"
         target="_blank"
         rel="noopener noreferrer"
         data-tooltip="ë¶€ì„œì™€ íŒ€ êµ¬ì„±ì„ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.">
        <div class="badge c-sky">OC</div>
        <div class="label">ì¡°ì§ë„</div>
      </a>

      <!-- ì—°ë½ì²˜ -->
      <a class="app"
         data-key="ì—°ë½ì²˜"
         href="https://compassionkorea.sharepoint.com/:b:/s/share/EW4HfbQ0aUdEsSm7fBLWAHMBbWviKQ6R6FUxvvXu7P3k7Q?e=padbKz"
         target="_blank"
         rel="noopener noreferrer"
         data-tooltip="ì‚¬ë‚´ ì£¼ìš” ì—°ë½ì²˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.">
        <div class="badge c-purple">ì—°ë½</div>
        <div class="label">ì—°ë½ì²˜</div>
      </a>

      <!-- ì‚¬ë²ˆ -->
      <a class="app"
         data-key="ì‚¬ë²ˆ"
         href="#"
         target="_blank"
         rel="noopener noreferrer"
         data-tooltip="ì‚¬ë²ˆ ê´€ë ¨ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê±°ë‚˜ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.">
        <div class="badge c-orange">ID</div>
        <div class="label">ì‚¬ë²ˆ</div>
      </a>

      <!-- LMS êµìœ¡ -->
      <a class="app"
         data-key="LMS êµìœ¡"
         href="https://hrd.compassion.or.kr/index.do"
         target="_blank"
         rel="noopener noreferrer"
         data-tooltip="ì‚¬ë‚´ êµìœ¡ í”Œë«í¼(LMS) ìˆ˜ê°• ë° ì´ë ¥ ê´€ë¦¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.">
        <div class="badge c-green">LMS</div>
        <div class="label">LMS êµìœ¡</div>
      </a>

      <span></span><span></span><span></span>
    </div>
  </div>
  <div class="folder-label" id="sec-pc"><span>P&amp;C</span></div>
</section>

    <!-- ğŸ‘ ì¬ê²½ -->
    <section aria-labelledby="sec-fin">
      <div class="folder" role="group" aria-labelledby="sec-fin">
        <div class="apps">
          <a class="app" data-key="ê·¸ë£¹ì›¨ì–´" href="http://gwa.compassion.or.kr/gw/userMain.do" target="_blank" rel="noopener noreferrer"><div class="badge c-green">GW</div><div class="label">ê·¸ë£¹ì›¨ì–´</div></a>
          <a class="app" data-key="Bizplay" href="https://www.bizplay.co.kr/main_0003_01.act" target="_blank" rel="noopener noreferrer"><div class="badge c-orange">ë¹„í”Œ</div><div class="label">Bizplay</div></a>
          <a class="app" data-key="Chat FIN" href="https://handy-reply-c1d.notion.site/ChatFIN-5b4bfe383a864a658cd59dd7de0bc671" target="_blank" rel="noopener noreferrer"><div class="badge c-teal">FIN</div><div class="label">Chat FIN</div></a>
          <span></span><span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-fin"><span>ì¬ê²½</span></div>
    </section>

    <!-- âœ” ì‹ ì²­/ì ‘ìˆ˜ -->
    <section aria-labelledby="sec-apply">
      <div class="folder" role="group" aria-labelledby="sec-apply">
        <div class="apps">
          <a class="app" data-key="Blue line" href="https://docs.google.com/forms/d/1SyKV9_o6ctBeClGW8wDpPnGf94RvEZqWaYfZ9e6cgxg/viewform?edit_requested=true" target="_blank" rel="noopener noreferrer"><div class="badge c-blue">BL</div><div class="label">Blue line</div></a>
          <a class="app" data-key="CS" href="https://compassionkorea-my.sharepoint.com/:x:/g/personal/dalim_compassion_or_kr/EQ_Gs9DNgN9PiUWxnUlVemoB07hunygEASEHkVd9av4EOQ?e=wvJixF" target="_blank" rel="noopener noreferrer"><div class="badge c-orange">CS</div><div class="label">CSì‹ ì²­</div></a>
          <a class="app" data-key="L&L" href="https://forms.office.com/r/TtTWjVKUGt" target="_blank" rel="noopener noreferrer"><div class="badge c-teal">L&L</div><div class="label">LUNCH & LEARN</div></a>
          <a class="app" data-key="IT HELP" href="https://compassionkorea.lightning.force.com/lightning/o/ITServiceRequest__c/home" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">IT</div><div class="label">IT HELP</div></a>
          <a class="app" data-key="OA ì„œë¹„ìŠ¤" href="https://forms.office.com/pages/responsepage.aspx?id=F3AWrGQVgEyEyvVroUgajahITEsIIu5IoQ0dkMJU9PRUQ0hNSjY3NEtQWTJPWktSTzZVSE04OFE2SCQlQCN0PWcu&route=shorturl" target="_blank" rel="noopener noreferrer"><div class="badge c-purple">OA</div><div class="label">OA ì„œë¹„ìŠ¤</div></a>
          <a class="app" data-key="ì—…ë¬´ìš”ì²­" href="https://compassionkorea.sharepoint.com/sites/request" target="_blank" rel="noopener noreferrer"><div class="badge c-green">ìš”ì²­</div><div class="label">ì—…ë¬´ìš”ì²­</div></a>
          <span></span><span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-apply"><span>ì‹ ì²­/ì ‘ìˆ˜</span></div>
    </section>

    <!-- ğŸ¬ ë¸Œëœë”© -->
    <section aria-labelledby="sec-brand">
      <div class="folder" role="group" aria-labelledby="sec-brand">
        <div class="apps">
          <a class="app" data-key="ë¸Œëœë“œ í—ˆë¸Œ" href="https://compassionkorea.sharepoint.com/sites/BrandHub" target="_blank" rel="noopener noreferrer"><div class="badge c-purple">í—ˆë¸Œ</div><div class="label">ë¸Œëœë“œ í—ˆë¸Œ</div></a>
          <a class="app" data-key="ìœ íŠœë¸Œ" href="https://www.youtube.com/@CompassionKR" target="_blank" rel="noopener noreferrer"><div class="badge c-red">YouTube</div><div class="label">ìœ íŠœë¸Œ</div></a>
          <a class="app" data-key="ìˆì¸ " href="https://www.youtube.com/@CompassionKR/shorts" target="_blank" rel="noopener noreferrer"><div class="badge c-blue">ìˆì¸ </div><div class="label">ìˆì¸ </div></a>
          <a class="app" data-key="ë„¤ì´ë²„ í¬ìŠ¤íŠ¸" href="https://blog.naver.com/prologue/PrologueList.naver?blogId=compassionkorea&skinType=&skinId=&from=menu&userSelectMenu=true" target="_blank" rel="noopener noreferrer"><div class="badge c-green">NAVER</div><div class="label">ë„¤ì´ë²„ í¬ìŠ¤íŠ¸</div></a>
          <span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-brand"><span>ë¸Œëœë”©</span></div>
    </section>

    <!-- ğŸ’œ Website -->
    <section aria-labelledby="sec-web">
      <div class="folder" role="group" aria-labelledby="sec-web">
        <div class="apps">
          <a class="app" data-key="ê¸€ë¡œë²Œ ONE" href="https://one.compassion.com" target="_blank" rel="noopener noreferrer"><div class="badge c-teal">ONE</div><div class="label">ê¸€ë¡œë²Œ ONE</div></a>
          <a class="app" data-key="CSF" href="https://compassionkorea.lightning.force.com/lightning/page/home" target="_blank" rel="noopener noreferrer"><div class="badge c-gray">CSF</div><div class="label">CSF</div></a>
          <a class="app" data-key="í™ˆí˜ì´ì§€" href="https://www.compassion.or.kr/" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">CK</div><div class="label">í•œêµ­ì»´íŒ¨ì…˜</div></a>
          <a class="app" data-key="US" href="http://www.compassion.com/" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">US</div><div class="label">ì»´íŒ¨ì…˜ US</div></a>
          <a class="app" data-key="AU" href="https://www.compassion.com.au/" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">AU</div><div class="label">ì»´íŒ¨ì…˜ AU</div></a>
          <a class="app" data-key="UK" href="https://www.compassionuk.org/" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">UK</div><div class="label">ì»´íŒ¨ì…˜ UK</div></a>
          <a class="app" data-key="CA" href="https://www.compassion.ca/" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">CA</div><div class="label">ì»´íŒ¨ì…˜ CA</div></a>
          <span></span><span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-web"><span>Website</span></div>
    </section>

    <!-- ğŸ§© íƒ€ê¸°ê´€ -->
    <section aria-labelledby="sec-ngo">
      <div class="folder" role="group" aria-labelledby="sec-ngo">
        <div class="apps">
          <a class="app" data-key="ì›”ë“œë¹„ì „" href="https://www.worldvision.or.kr/" target="_blank" rel="noopener noreferrer" title="ì›”ë“œë¹„ì „"><div class="badge c-orange">WV</div><div class="label">ì›”ë“œë¹„ì „</div></a>
          <a class="app" data-key="ìœ ë‹ˆì„¸í”„" href="https://www.unicef.or.kr/" target="_blank" rel="noopener noreferrer" title="ìœ ë‹ˆì„¸í”„"><div class="badge c-sky">UNICEF</div><div class="label">ìœ ë‹ˆì„¸í”„</div></a>
          <a class="app" data-key="êµ¿ë„¤ì´ë²„ìŠ¤" href="https://www.goodneighbors.kr/" target="_blank" rel="noopener noreferrer" title="êµ¿ë„¤ì´ë²„ìŠ¤"><div class="badge c-green">GN</div><div class="label">êµ¿ë„¤ì´ë²„ìŠ¤</div></a>
          <a class="app" data-key="ì„¸ì´ë¸Œë”ì¹ ë“œëŸ°" href="https://www.sc.or.kr/" target="_blank" rel="noopener noreferrer" title="ì„¸ì´ë¸Œë”ì¹ ë“œëŸ°"><div class="badge c-red">SC</div><div class="label">ì„¸ì´ë¸Œ</div></a>
          <a class="app" data-key="ê¸°ì•„ëŒ€ì±…" href="https://www.kfhi.or.kr/" target="_blank" rel="noopener noreferrer" title="ê¸°ì•„ëŒ€ì±…"><div class="badge c-purple">KFHI</div><div class="label">ê¸°ì•„ëŒ€ì±…</div></a>
          <a class="app" data-key="ì´ˆë¡ìš°ì‚°" href="https://www.childfund.or.kr/main.do" target="_blank" rel="noopener noreferrer" title="ì´ˆë¡ìš°ì‚° ì–´ë¦°ì´ì¬ë‹¨"><div class="badge c-teal">CF</div><div class="label">ì´ˆë¡ìš°ì‚°</div></a>
          <a class="app" data-key="ë°€ì•Œ" href="https://miral.org/main/main.asp" target="_blank" rel="noopener noreferrer" title="ë°€ì•Œ ë³µì§€ì¬ë‹¨"><div class="badge c-gray">ë°€ì•Œ</div><div class="label">ë°€ì•Œ</div></a>
          <span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-ngo"><span>íƒ€ê¸°ê´€</span></div>
    </section>
  </div>
  <!-- ====================== /ë°”ë¡œê°€ê¸° ====================== -->

  <!-- ====================== ì „ì‚¬ì¼ì •&í–‰ì‚¬ ====================== -->
  <section class="sp-hero" aria-labelledby="ecal-title">
    <div class="sp-titlebar">
      <h2 id="ecal-title">Enterprise Calendar</h2>
      <div class="sp-actions" role="toolbar" aria-label="Calendar actions">
        <button type="button" class="btn ghost" id="btn-compact" aria-pressed="false" title="ë°€ì§‘ ë³´ê¸°">Compact</button>
        <button type="button" class="btn" id="btn-export" title="CSVë¡œ ë‚´ë³´ë‚´ê¸°">Export</button>
        <!-- ìƒˆ ì°½ìœ¼ë¡œ Add Event -->
        <a class="btn primary" id="btn-add" href="https://sungha85.github.io/compassion_gate/event/" target="_blank" rel="noopener" title="ì¼ì • ì¶”ê°€">Add Event</a>
      </div>
    </div>
    <p class="sp-sub">ì›í•˜ëŠ” ì—°Â·ì›”ì„ ì„ íƒí•´ í•´ë‹¹ ë‹¬ì˜ ì¼ì •ë§Œ í™•ì¸í•˜ì„¸ìš”.</p>
  </section>

  <!-- ì—°/ì›” ì»¨íŠ¸ë¡¤ -->
  <div class="cal-controls">
    <button class="btn" id="prev-month" title="ì´ì „ ë‹¬">â—€</button>
    <select id="year-select" aria-label="ì—°ë„ ì„ íƒ"></select>
    <div class="seg" id="month-buttons" role="tablist" aria-label="ì›” ì„ íƒ"></div>
    <button class="btn" id="next-month" title="ë‹¤ìŒ ë‹¬">â–¶</button>
    <label style="margin-left:auto;display:flex;align-items:center;gap:6px;">
      <input type="checkbox" id="toggle-annual"> ì—°ê°„ ë³´ê¸°
    </label>
  </div>

  <!-- ë§¤íŠ¸ë¦­ìŠ¤ -->
  <div class="card year-grid" style="margin-top:8px" id="year-grid" aria-labelledby="year-title">
    <div id="year-title" class="visually-hidden" aria-hidden="true">ì¼ì • ë§¤íŠ¸ë¦­ìŠ¤</div>
    <div class="header" id="grid-header"></div>
    <div id="lane-rows"></div>
    <div class="grid-lines" id="grid-lines" aria-hidden="true"></div>
    <div class="today-line" id="today-line" aria-hidden="true"></div>
    <div class="bar-layer" id="bar-layer"></div>
  </div>
</div>

<!-- ê³µìš© ëª¨ë‹¬ -->
<div id="modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="m-title" aria-describedby="m-when m-dept m-note" style="display:none;align-items:center;justify-content:center;position:fixed;inset:0;background:rgba(0,0,0,.45);padding:20px">
  <div class="box" style="background:#fff;border-radius:14px;padding:18px;max-width:560px;width:100%;border:1px solid var(--grid);box-shadow:0 10px 30px rgba(0,0,0,.15)">
    <h3 id="m-title" style="margin:0 0 8px;font-size:16px"></h3>
    <p id="m-when" style="margin:6px 0 0;font-size:13px;color:#334155;white-space:pre-line"></p>
    <p id="m-dept" style="margin:6px 0 0;font-size:13px;color:#334155;white-space:pre-line"></p>
    <p id="m-note" style="margin:6px 0 0;font-size:13px;color:#334155;white-space:pre-line"></p>
    <div class="modal-actions" style="display:flex;justify-content:flex-end;gap:8px;margin-top:16px"><button class="close btn" id="closeBtn">ë‹«ê¸° (Esc)</button></div>
  </div>
</div>

<!-- ì•± ë§í¬ í¸ì§‘ ëª¨ë‹¬ -->
<div id="app-links-modal" aria-hidden="true" role="dialog" aria-modal="true"
     style="position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:20px;z-index:60">
  <div style="background:#fff;border:1px solid var(--grid);border-radius:14px;max-width:720px;width:100%;padding:16px">
    <h3 style="margin:0 0 8px">ì•± ë§í¬ ë¶™ì—¬ë„£ê¸°</h3>
    <p class="muted" style="margin:0 0 8px">í˜•ì‹: <code>key,url</code> â€” ì˜ˆ) <code>ì¡°ì§ë„,https://...</code></p>
    <textarea id="app-links-text" style="width:100%;height:200px;border:1px solid var(--grid);border-radius:10px;padding:8px" placeholder="key,url&#10;ì¡°ì§ë„,https://..."></textarea>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
      <button id="app-links-cancel" class="btn" type="button">ì·¨ì†Œ</button>
      <button id="app-links-apply" class="btn primary" type="button">ì ìš©</button>
    </div>
  </div>
</div>
<!-- ë”ë³´ê¸° ëª¨ë‹¬ -->
<div id="more-modal" aria-hidden="true" role="dialog" aria-modal="true">
  <div class="more-box" role="document">
    <h3 class="more-title" id="more-title">ë” ë§ì€ ì•±</h3>
    <div class="more-grid" id="more-grid" aria-labelledby="more-title"></div>
    <div class="more-footer">
      <button class="btn" id="more-close">ë‹«ê¸°</button>
    </div>
  </div>
</div>

  

<script type="module">
  /* ===================== Firestore ì—°ë™ + ì›”/ì—°ë„ ë³´ê¸° ===================== */
  const $ = (s)=>document.querySelector(s);
  const KST = new Intl.DateTimeFormat('ko-KR',{ timeZone:'Asia/Seoul', dateStyle:'medium' });
  const fmtRange = (s,e)=> `${KST.format(s)} ~ ${KST.format(e)}`;
  const parseDate = (s)=>{ const [y,m,d] = s.split('-').map(Number); return new Date(y, m-1, d); };
  const monthNames = ["1ì›”","2ì›”","3ì›”","4ì›”","5ì›”","6ì›”","7ì›”","8ì›”","9ì›”","10ì›”","11ì›”","12ì›”"];

  const LANES = ["ëŒ€í‘œì‹¤","ì»´í”Œ","ì „ëµ","ì¬ê²½","P&C","ë¯¸ì…˜","êµíŒŒ","êµë¯¸","ë¹„ì „","ë¬´ë¸Œ","ë””ì´","ë§ˆìº ","ë¸Œì»´","í¬ë¦¬","íŠ¹í›„","IT","SE","SR"];
  const CATEGORIES = ["í–‰ì‚¬","ì—…ë¬´","ì‹ ì²­"];

  const headerEl = $("#grid-header");
  const rowsEl = $("#lane-rows");
  const linesEl = $("#grid-lines");
  const layerEl = $("#bar-layer");
  const todayEl = $("#today-line");

  // ë·° ìƒíƒœ
  const today = new Date();
  let viewYear  = today.getFullYear();
  let viewMonth = today.getMonth()+1; // 1..12
  let annual = false;

  // ì—°/ì›” ì»¨íŠ¸ë¡¤
  (function initYMControls(){
    const ysel = $("#year-select");
    const startY = today.getFullYear()-2, endY = today.getFullYear()+1;
    for(let y=startY;y<=endY;y++){
      const opt = document.createElement('option');
      opt.value = y; opt.textContent = y+'ë…„';
      if(y===viewYear) opt.selected = true;
      ysel.appendChild(opt);
    }
    ysel.addEventListener('change', ()=>{ viewYear = Number(ysel.value); buildGrid(); refresh(); });

    const mwrap = $("#month-buttons");
    monthNames.forEach((name,idx)=>{
      const m = idx+1;
      const b = document.createElement('button');
      b.textContent = name;
      b.setAttribute('role','tab');
      b.setAttribute('aria-pressed', String(viewMonth===m));
      b.addEventListener('click', ()=>{
        viewMonth = m;
        [...mwrap.children].forEach(x=>x.setAttribute('aria-pressed','false'));
        b.setAttribute('aria-pressed','true');
        if(!annual){ buildGrid(); refresh(); }
        else refresh();
      });
      mwrap.appendChild(b);
    });

    $("#prev-month").addEventListener('click', ()=>{
      if(viewMonth===1){ viewMonth=12; viewYear--; } else viewMonth--;
      ysel.value = String(viewYear);
      mwrap.children[viewMonth-1].click();
    });
    $("#next-month").addEventListener('click', ()=>{
      if(viewMonth===12){ viewMonth=1; viewYear++; } else viewMonth++;
      ysel.value = String(viewYear);
      mwrap.children[viewMonth-1].click();
    });

    const tgl = $("#toggle-annual");
    tgl.checked = annual;
    tgl.addEventListener('change', ()=>{ annual = tgl.checked; buildGrid(); refresh(); });
  })();

  // ê·¸ë¦¬ë“œ êµ¬ì„±(ì—°ê°„/ë‹¨ì›”)
  function buildGrid(){
    headerEl.innerHTML = '';
    rowsEl.innerHTML = '';
    linesEl.innerHTML = '';
    layerEl.innerHTML = '';

    if(annual){
      headerEl.style.gridTemplateColumns = `var(--left-col) repeat(12,1fr)`;
      rowsEl.style.gridTemplateColumns   = `var(--left-col) repeat(12,1fr)`;
      linesEl.style.inset = `var(--header-h) 0 0 var(--left-col)`;
      linesEl.style.display = 'grid';
      linesEl.style.gridTemplateColumns = `repeat(12,1fr)`;

      const empty = document.createElement('div');
      empty.style.borderRight = '1px solid var(--grid)';
      headerEl.appendChild(empty);
      for(let i=0;i<12;i++){
        const m = document.createElement('div');
        m.textContent = monthNames[i];
        headerEl.appendChild(m);
        const gl = document.createElement('div');
        linesEl.appendChild(gl);
      }
    }else{
      headerEl.style.gridTemplateColumns = `var(--left-col) 1fr`;
      rowsEl.style.gridTemplateColumns   = `var(--left-col) 1fr`;
      linesEl.style.inset = `var(--header-h) 0 0 var(--left-col)`;
      linesEl.style.display = 'grid';
      linesEl.style.gridTemplateColumns = `1fr`;

      const empty = document.createElement('div');
      empty.style.borderRight = '1px solid var(--grid)';
      headerEl.appendChild(empty);
      const m = document.createElement('div');
      m.textContent = `${viewYear}ë…„ ${monthNames[viewMonth-1]}`;
      headerEl.appendChild(m);
      const gl = document.createElement('div');
      linesEl.appendChild(gl);
    }

    // ë ˆì¸ í–‰
    LANES.forEach(name=>{
      const row = document.createElement('div');
      row.className = 'row';
      row.style.gridTemplateColumns = annual ? `var(--left-col) repeat(12,1fr)` : `var(--left-col) 1fr`;
      const lane = document.createElement('div');
      lane.className = 'lane-name';
      lane.textContent = name;
      row.appendChild(lane);
      const colCount = annual ? 12 : 1;
      for(let i=0;i<colCount;i++){
        const cell = document.createElement('div');
        cell.className = 'cell';
        row.appendChild(cell);
      }
      rowsEl.appendChild(row);
    });

    // ì˜¤ëŠ˜ ë¼ì¸ (ì—°ê°„ë§Œ)
    if(annual){
      const now = new Date();
      if(now.getFullYear()===viewYear){
        const month = now.getMonth();
        const day = now.getDate();
        const dim = new Date(now.getFullYear(), month+1, 0).getDate();
        const frac = month + (day-1)/dim;
        const leftPct = (frac/12)*100;
        todayEl.style.left = `calc(${leftPct}% + var(--left-col))`;
        todayEl.style.display = 'block';
      }else{
        todayEl.style.display = 'none';
      }
      todayEl.style.top = 'var(--header-h)';
      todayEl.style.bottom = '0';
    }else{
      todayEl.style.display = 'none';
    }

    layerEl.style.inset = `var(--header-h) 0 0 var(--left-col)`;
  }

  function laneY(laneName){
    const idx = LANES.indexOf(laneName);
    const header = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--header-h'));
    const laneH = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--lane-h'));
    const gap = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--lane-gap'));
    return header + idx * (laneH + gap);
  }

  // Firestore êµ¬ë…
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
  import { getFirestore, collection, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBsTMadItNXG9YqmtFYr9bX6lbt0qIh9FQ",
    authDomain: "dcp-page.firebaseapp.com",
    projectId: "dcp-page",
    storageBucket: "dcp-page.firebasestorage.app",
    messagingSenderId: "1056273445903",
    appId: "1:1056273445903:web:9e924f9bd476a860af1f7a",
    measurementId: "G-CZS1G9M1KQ"
  };

  const app = initializeApp(firebaseConfig);
  const db  = getFirestore(app);

  let EVENTS = [];
  const eventsRef = collection(db, 'events');
  const q = query(eventsRef, orderBy('start'));
  onSnapshot(q, (snapshot)=>{
    const next = [];
    snapshot.forEach(doc=>{
      const d = doc.data();
      next.push({
        id: doc.id,
        title: d.title || '(ì œëª© ì—†ìŒ)',
        start: d.start || '',
        end  : d.end   || '',
        category: d.category || '',
        lane: d.lane || '',
        note: d.note || ''
      });
    });
    next.sort((a,b)=> (a.start||'').localeCompare(b.start||''));
    EVENTS = next;
    refresh();
  }, (err)=> console.error('[Firestore] onSnapshot error:', err));

  // í—¬í¼: í•´ë‹¹ ì›”ê³¼ ê²¹ì¹˜ëŠ”ê°€?
  function intersectsMonth(ev, y, m){
    if(!ev.start || !ev.end) return false;
    const s = parseDate(ev.start), e = parseDate(ev.end);
    const first = new Date(y, m-1, 1);
    const last  = new Date(y, m, 0);
    return s <= last && e >= first;
  }

  function renderBars(){
    layerEl.innerHTML = '';
    const list = annual ? EVENTS : EVENTS.filter(ev => intersectsMonth(ev, viewYear, viewMonth));

    list.forEach(ev=>{
      if(!ev.lane || LANES.indexOf(ev.lane)<0) return;

      let leftPct = 0, widthPct = 100;
      if(annual){
        const s = parseDate(ev.start||`${viewYear}-01-01`);
        const startIdx = Math.min(11, Math.max(0, s.getMonth()));
        leftPct = (startIdx/12)*100;
        const e = parseDate(ev.end||`${viewYear}-12-31`);
        const months = (e.getFullYear()-s.getFullYear())*12 + (e.getMonth()-s.getMonth()) + 1;
        widthPct = Math.max(1, Math.min(12, months)) / 12 * 100;
      }else{
        leftPct = 0; widthPct = 100; // ë‹¨ì›”: í•œ ì¹¸
      }

      const bar = document.createElement('div');
      bar.className = `event t-${ev.lane}`;
      bar.style.left = `calc(${leftPct}% + 6px)`;
      bar.style.top  = `${laneY(ev.lane) + 18}px`;
      bar.style.width= `calc(${widthPct}% - 12px)`;
      bar.tabIndex = 0;
      bar.setAttribute('role','button');
      bar.setAttribute('aria-label', `${ev.lane} Â· ${ev.title} Â· ${ev.start} ~ ${ev.end} Â· ${ev.category}`);
      bar.textContent = ev.title || '(ì œëª© ì—†ìŒ)';
      bar.addEventListener('click', ()=>openModal(ev));
      bar.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); openModal(ev); } });
      layerEl.appendChild(bar);
    });
  }

  function openModal(ev){
    $("#m-title").textContent = ev.title || '(ì œëª© ì—†ìŒ)';
    const s = ev.start?parseDate(ev.start):null, e = ev.end?parseDate(ev.end):null;
    $("#m-when").textContent = (s && e) ? `ì¼ì •: ${fmtRange(s,e)}` : '';
    $("#m-dept").textContent = `íŒ€: ${ev.lane||''} Â· ì¹´í…Œê³ ë¦¬: ${ev.category||''}`;
    $("#m-note").textContent = ev.note ? `ë©”ëª¨: ${ev.note}` : '';
    const modal = $("#modal");
    modal.style.display='flex';
    modal.setAttribute('aria-hidden','false');
    document.body.style.overflow='hidden';
    $("#closeBtn").focus();
  }
  function closeModal(){
    const modal = $("#modal");
    modal.style.display='none';
    modal.setAttribute('aria-hidden','true');
    document.body.style.overflow='';
  }
  $("#modal")?.addEventListener('click', (e)=>{ if(e.target.id==='modal') closeModal(); });
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeModal(); });
  $("#closeBtn")?.addEventListener('click', closeModal);

  // Compact í† ê¸€
  $("#btn-compact")?.addEventListener('click', ()=>{
    const on = document.body.classList.toggle('compact');
    $("#btn-compact").setAttribute('aria-pressed', String(on));
    refresh();
  });

  // Export CSV
  $("#btn-export")?.addEventListener('click', ()=>{
    const headers=["title","start","end","lane","category","note"];
    const source = annual ? EVENTS : EVENTS.filter(ev => intersectsMonth(ev, viewYear, viewMonth));
    const rows=[headers.join(",")].concat(
      source.map(ev=>headers.map(h=>{
        const val=(ev[h]??"").toString().replace(/"/g,'"');
        return /[",\n]/.test(val)?`"${val}"`:val;
      }).join(","))
    );
    const csv = rows.join("\n");
    const blob = new Blob([csv], {type:"text/csv;charset=utf-8;"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = `calendar_${annual?'year':'month'}.csv`;
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  });

  // ì´ë¯¸ì§€ ì¸ë„¤ì¼ ëª¨ë‹¬
  let imageAvailable=false;
  window.calendarImageReady=()=>{ imageAvailable=true; };
  window.calendarImageMissing=()=>{ imageAvailable=false; document.querySelector('.imgbox')?.remove(); };
  window.openImage=()=>{
    if(!imageAvailable) return;
    $("#m-title").textContent='ì „ì‚¬ì¼ì •&í–‰ì‚¬ (ì´ë¯¸ì§€)';
    $("#m-when").innerHTML='<img src="enterprise-calendar.png" style="width:100%;border:1px solid #e5e7eb;border-radius:8px" alt="calendar" />';
    $("#m-dept").textContent='';
    $("#m-note").textContent='';
    const modal = $("#modal");
    modal.style.display='flex';
    modal.setAttribute('aria-hidden','false');
    document.body.style.overflow='hidden';
    $("#closeBtn").focus();
  };

  function refresh(){ renderBars(); }
  window.addEventListener('resize', refresh);
// ===== Tooltip (ìš”ì†Œ ì¤‘ì‹¬ ê³ ì •, top/bottom ìë™ í”Œë¦½) =====
(function setupTooltip(){
  const tip = document.createElement('div');
  tip.className = 'tooltip';
  tip.setAttribute('role', 'tooltip');
  tip.setAttribute('aria-hidden', 'true');
  document.body.appendChild(tip);

  let activeEl = null;

  function placeTipFor(el){
    if(!el) return;
    const rect = el.getBoundingClientRect();
    const margin = 10;       // í™”ë©´ ëª¨ì„œë¦¬ ì—¬ë°±
    const gap = 10;          // ìš”ì†Œì™€ íˆ´íŒ ê°„ê²©

    // ë¨¼ì € ê°€ìš´ë° ì •ë ¬ë¡œ ë†“ê³  í¬ê¸° ì¸¡ì •
    tip.style.left = `${rect.left + rect.width/2}px`;
    tip.style.top  = `${rect.top - gap}px`;
    tip.style.transform = 'translate(-50%, -100%)'; // ìœ„ìª½ ê¸°ì¤€
    tip.dataset.pos = 'top';

    // ë ˆì´ì•„ì›ƒ ê³„ì‚° í›„ í™”ë©´ ë°–ì´ë©´ ì•„ë˜ìª½ìœ¼ë¡œ í”Œë¦½
    const r = tip.getBoundingClientRect();
    if(r.top < margin){
      tip.style.top = `${rect.bottom + gap}px`;
      tip.style.transform = 'translate(-50%, 0)';   // ì•„ë˜ìª½ ê¸°ì¤€
      tip.dataset.pos = 'bottom';
    }

    // ì¢Œìš°ë„ í™”ë©´ ë°–ì´ë©´ ì‚´ì§ ì•ˆìª½ìœ¼ë¡œ ë³´ì •
    const r2 = tip.getBoundingClientRect();
    let left = r2.left, right = r2.right, vw = window.innerWidth;
    let dx = 0;
    if(left < margin) dx = margin - left;
    else if(right > vw - margin) dx = (vw - margin) - right;
    if(dx !== 0){
      const currentLeft = parseFloat(tip.style.left);
      tip.style.left = `${currentLeft + dx}px`;
    }
  }

  function showTip(el){
    const text = el.getAttribute('data-tooltip');
    if(!text) return;
    activeEl = el;
    tip.textContent = text;
    tip.dataset.show = 'true';
    tip.setAttribute('aria-hidden', 'false');
    placeTipFor(el);
  }

  function hideTip(){
    activeEl = null;
    tip.dataset.show = 'false';
    tip.setAttribute('aria-hidden', 'true');
  }

  // ì´ë²¤íŠ¸ ìœ„ì„: ë§ˆìš°ìŠ¤
  document.addEventListener('mouseover', e=>{
    const el = e.target.closest('[data-tooltip]');
    if(!el) return;
    showTip(el);
  });
  document.addEventListener('mouseout', e=>{
    if(activeEl && !e.relatedTarget?.closest('[data-tooltip]')) hideTip();
  });

  // í‚¤ë³´ë“œ ì ‘ê·¼ì„±
  document.addEventListener('focusin', e=>{
    const el = e.target.closest('[data-tooltip]');
    if(!el) return;
    showTip(el);
  });
  document.addEventListener('focusout', e=>{
    if(e.target.closest('[data-tooltip]')) hideTip();
  });

  // ë¦¬ì‚¬ì´ì¦ˆ/ìŠ¤í¬ë¡¤ ì‹œ ìœ„ì¹˜ ì¬ê³„ì‚°
  ['scroll','resize'].forEach(type=>{
    window.addEventListener(type, ()=>{
      if(activeEl && tip.dataset.show === 'true') placeTipFor(activeEl);
    }, { passive:true });
  });
})();

  
  // ìµœì´ˆ ë¹Œë“œ/ë Œë”
  buildGrid();
  refresh();

  /* ===================== ì•± ë§í¬ í¸ì§‘(ì„ íƒê¸°ëŠ¥) ===================== */
  const APP_LINKS_LS='portal:app_links:v2';
  const $alb=document.getElementById('app-links-btn'),
        $alm=document.getElementById('app-links-modal'),
        $alt=document.getElementById('app-links-text'),
        $ala=document.getElementById('app-links-apply'),
        $alc=document.getElementById('app-links-cancel');

  function loadAppLinks(){try{const s=localStorage.getItem(APP_LINKS_LS);return s?JSON.parse(s):{};}catch(e){return {};} }
  function saveAppLinks(map){localStorage.setItem(APP_LINKS_LS,JSON.stringify(map));}
  function applyAppLinks(){
    const map=loadAppLinks();
    document.querySelectorAll('.app[data-key]').forEach(a=>{
      const key=a.getAttribute('data-key'); const url=map[key];
      if(url){ a.href=url; a.target='_blank'; a.rel='noopener noreferrer'; a.title=(a.title||key)+' (ì—´ê¸°)'; }
    });
  }
  function openAL(){
    $alm.style.display='flex';
    $alm.setAttribute('aria-hidden','false');
    const map=loadAppLinks();
    const keys=[...document.querySelectorAll('.app[data-key]')].map(a=>a.getAttribute('data-key'));
    const lines=keys.map(k=>`${k},${map[k]||''}`).join('\n');
    $alt.value='key,url\n'+lines;
    $alt.focus();
  }
  function closeAL(){ $alm.style.display='none'; $alm.setAttribute('aria-hidden','true'); }
  function parseLinksCSV(text){
    const rows=text.trim().split(/\r?\n/).map(r=>r.split(',').map(s=>s.trim()));
    if(rows.length && /^key$/i.test(rows[0][0])) rows.shift();
    const out={}; rows.forEach(([k,u])=>{ if(k) out[k]=u||'#'; }); return out;
  }

  $alb.addEventListener('click',openAL);
  $alc.addEventListener('click',closeAL);
  $alm.addEventListener('click',e=>{ if(e.target.id==='app-links-modal') closeAL(); });
  $ala.addEventListener('click',()=>{
    const parsed=parseLinksCSV($alt.value);
    if(!Object.keys(parsed).length){alert('ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');return;}
    const merged={...loadAppLinks(),...parsed};
    saveAppLinks(merged); applyAppLinks(); closeAL();
    alert('ì•± ë§í¬ê°€ ë°˜ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.');
  });

  applyAppLinks();
/* ===================== 6ìŠ¬ë¡¯(5ì•±+ë”ë³´ê¸°) ë ˆì´ì•„ì›ƒ ===================== */
(function setupSixSlots(){
  const MAX_FIXED = 5; // ë³´ì—¬ì¤„ ì•± ìŠ¬ë¡¯ ê°œìˆ˜
  document.querySelectorAll('#quick-grid > section .apps').forEach(appsEl=>{
    // ê¸°ì¡´ì— ë§Œë“  ë”ë³´ê¸°/ë¹ˆìŠ¬ë¡¯ì´ ìˆìœ¼ë©´ ì •ë¦¬
    appsEl.querySelectorAll('.more-tile, .slot-empty').forEach(n=>n.remove());

    const apps = [...appsEl.querySelectorAll('.app')];
    // 5ê°œ ì´í›„ëŠ” ì ‘ì–´ë‘ê¸°
    const hidden = apps.slice(MAX_FIXED);
    hidden.forEach(a=>a.style.display='none');

    // 5ê°œ ë¯¸ë§Œì´ë©´ ë¹ˆì¹¸ìœ¼ë¡œ ì±„ìš°ê¸°
    const need = Math.max(0, MAX_FIXED - Math.min(apps.length, MAX_FIXED));
    for(let i=0;i<need;i++){
      const ph = document.createElement('span');
      ph.className = 'slot-empty';
      appsEl.appendChild(ph);
    }

    // 6ë²ˆì§¸: ë”ë³´ê¸° íƒ€ì¼(í•­ìƒ í‘œì‹œ)
    const more = document.createElement('button');
    more.type = 'button';
    more.className = 'app more-tile';
    more.setAttribute('aria-haspopup', 'dialog');

    // ì•±ê³¼ ë™ì¼í•œ êµ¬ì¡°(ë°°ì§€+ë¼ë²¨)ë¡œ í‘œí˜„
    const badge = document.createElement('div');
    badge.className = 'badge c-gray';
    badge.textContent = hidden.length ? `+${hidden.length}` : '+0';
    const label = document.createElement('div');
    label.className = 'label';
    label.textContent = 'ë”ë³´ê¸°';

    more.appendChild(badge);
    more.appendChild(label);
    appsEl.appendChild(more);
  });
})();

/* ===================== ë”ë³´ê¸° ëª¨ë‹¬ (ìœ„ì„) ===================== */
(function moreModalDelegation(){
  const quickGrid = document.getElementById('quick-grid');
  const modal  = document.getElementById('more-modal');
  const box    = document.getElementById('more-grid');
  const title  = document.getElementById('more-title');
  const closeB = document.getElementById('more-close');

  function openFor(appsEl){
    const apps = [...appsEl.querySelectorAll('.app')]; // ëª¨ë“  ì•±(ìˆ¨ê¸´ ê²ƒë„ í¬í•¨)
    const groupLabel = appsEl.closest('section')?.querySelector('.folder-label span')?.textContent?.trim() || 'ì•± ëª©ë¡';
    title.textContent = groupLabel;

    box.innerHTML = '';
    apps.forEach(a=>{
      const card = document.createElement('a');
      card.className = 'more-app';
      card.href = a.href || '#';
      card.target = a.target || '_blank';
      if(a.rel) card.rel = a.rel;
      const b = a.querySelector('.badge')?.cloneNode(true);
      const l = a.querySelector('.label')?.cloneNode(true);
      if(b) card.appendChild(b);
      if(l) card.appendChild(l);
      box.appendChild(card);
    });

    modal.setAttribute('aria-hidden','false');
    document.body.style.overflow='hidden';
    closeB?.focus();
  }

  quickGrid?.addEventListener('click', e=>{
    const btn = e.target.closest('.more-tile');
    if(!btn) return;
    const appsEl = btn.closest('.apps');
    if(appsEl) openFor(appsEl);
  });

  const close = ()=>{ modal.setAttribute('aria-hidden','true'); document.body.style.overflow=''; };
  closeB?.addEventListener('click', close);
  modal?.addEventListener('click', e=>{ if(e.target.id === 'more-modal') close(); });
  document.addEventListener('keydown', e=>{ if(modal.getAttribute('aria-hidden')==='false' && e.key==='Escape') close(); });
})();

  /* ===================== ì•± íˆ´íŒ ìë™ ì ìš© ===================== */
(function applyAppTooltips(){
  // 1) í‚¤ = data-key, ê°’ = íˆ´íŒ í…ìŠ¤íŠ¸ (ì›í•˜ëŠ” ëŒ€ë¡œ ìˆ˜ì •/ë³´ê°•í•˜ë©´ ë¨)
  const TOOLTIP_MAP = {
    // í˜„í™©
    "CDSP": "í›„ì›ì•„ë™ í˜„í™© ëŒ€ì‹œë³´ë“œë¥¼ í™•ì¸í•©ë‹ˆë‹¤.",
    "KRI": "í•µì‹¬ì„±ê³¼ì§€í‘œ(KRI) ëŒ€ì‹œë³´ë“œì…ë‹ˆë‹¤.",
    "LE": "LE ì§€í‘œ ìë£Œ(ìŠ¤í”„ë ˆë“œì‹œíŠ¸)ì…ë‹ˆë‹¤.",
    "Scorecard": "Global Scorecard(ê¸€ë¡œë²Œ ì„±ê³¼í˜„í™©)ì…ë‹ˆë‹¤.",

    // P&C (ì´ë¯¸ ìˆëŠ” ê±´ ë®ì–´ì“°ì§€ ì•ŠìŒ)
    "ì¸ì‚¬ê·¼íƒœ": "ì¶œí‡´ê·¼/ì—°ì°¨ ë“± ê·¼íƒœ í™•ì¸",
    "ì¡°ì§ë„": "ë¶€ì„œÂ·íŒ€ ì¡°ì§ë„ ì—´ê¸°",
    "ì—°ë½ì²˜": "ì‚¬ë‚´ ì£¼ìš” ì—°ë½ì²˜ ë³´ê¸°",
    "ì‚¬ë²ˆ": "ì‚¬ë²ˆ ê´€ë ¨ ì •ë³´ ì¡°íšŒ/ê´€ë¦¬",
    "LMS êµìœ¡": "ì‚¬ë‚´ êµìœ¡(LMS) ìˆ˜ê°•Â·ì´ë ¥ ê´€ë¦¬",

    // ì¬ê²½
    "ê·¸ë£¹ì›¨ì–´": "ì „ìê²°ì¬/ë©”ì¼ ë“± ê·¸ë£¹ì›¨ì–´ ë©”ì¸",
    "Bizplay": "ë²•ì¸ì¹´ë“œ ì˜ìˆ˜ì¦Â·ë¹„ìš© ì •ì‚°",
    "Chat FIN": "ì¬ê²½íŒ€ìš© ì§€ì‹/ë„êµ¬ í—ˆë¸Œ",

    // ì‹ ì²­/ì ‘ìˆ˜
    "Blue line": "ë¸”ë£¨ë¼ì¸ ì‹ ì²­ í¼",
    "CS": "CS ì—…ë¬´ ì‹ ì²­ ìŠ¤í”„ë ˆë“œì‹œíŠ¸",
    "L&L": "ëŸ°ì¹˜&ëŸ°(L&L) ì‹ ì²­ í¼",
    "IT HELP": "IT ì„œë¹„ìŠ¤ ìš”ì²­/ë¬¸ì˜",
    "OA ì„œë¹„ìŠ¤": "OA(ì˜¤í”¼ìŠ¤) ì„œë¹„ìŠ¤ ì‹ ì²­",
    "ì—…ë¬´ìš”ì²­": "ì‚¬ë‚´ ì—…ë¬´ ìš”ì²­ í¬í„¸",

    // ë¸Œëœë”©
    "ë¸Œëœë“œ í—ˆë¸Œ": "ë¸Œëœë“œ ê°€ì´ë“œ/ìì‚° ëª¨ìŒ",
    "ìœ íŠœë¸Œ": "ì»´íŒ¨ì…˜KR ìœ íŠœë¸Œ ì±„ë„",
    "ìˆì¸ ": "ì»´íŒ¨ì…˜KR ìœ íŠœë¸Œ ìˆì¸ ",
    "ë„¤ì´ë²„ í¬ìŠ¤íŠ¸": "ì»´íŒ¨ì…˜ ê³µì‹ í¬ìŠ¤íŠ¸",

    // Website
    "ê¸€ë¡œë²Œ ONE": "Global ONE í¬í„¸",
    "CSF": "Salesforce í™ˆ",
    "í™ˆí˜ì´ì§€": "ì»´íŒ¨ì…˜ ì½”ë¦¬ì•„ í™ˆí˜ì´ì§€",
    "US": "ì»´íŒ¨ì…˜ ë¯¸êµ­",
    "AU": "ì»´íŒ¨ì…˜ í˜¸ì£¼",
    "UK": "ì»´íŒ¨ì…˜ ì˜êµ­",
    "CA": "ì»´íŒ¨ì…˜ ìºë‚˜ë‹¤",

    // íƒ€ê¸°ê´€
    "ì›”ë“œë¹„ì „": "ì›”ë“œë¹„ì „ ê³µì‹ í™ˆí˜ì´ì§€",
    "ìœ ë‹ˆì„¸í”„": "ìœ ë‹ˆì„¸í”„ í•œêµ­ìœ„ì›íšŒ",
    "êµ¿ë„¤ì´ë²„ìŠ¤": "êµ¿ë„¤ì´ë²„ìŠ¤",
    "ì„¸ì´ë¸Œë”ì¹ ë“œëŸ°": "ì„¸ì´ë¸Œë”ì¹ ë“œëŸ°",
    "ê¸°ì•„ëŒ€ì±…": "ê¸°ì•„ëŒ€ì±…",
    "ì´ˆë¡ìš°ì‚°": "ì´ˆë¡ìš°ì‚° ì–´ë¦°ì´ì¬ë‹¨",
    "ë°€ì•Œ": "ë°€ì•Œë³µì§€ì¬ë‹¨"
  };

  // 2) ì´ë¯¸ data-tooltip ìˆëŠ” ê²½ìš°ëŠ” ê±´ë“œë¦¬ì§€ ì•Šê³ ,
  //    (a) data-key ë§¤ì¹­, (b) ì—†ìœ¼ë©´ .label í…ìŠ¤íŠ¸ë¡œ ë§¤ì¹­, (c) ê·¸ë˜ë„ ì—†ìœ¼ë©´ titleì„ data-tooltipìœ¼ë¡œ ìŠ¹ê²©
  document.querySelectorAll('#quick-grid .app').forEach(a=>{
    if (a.hasAttribute('data-tooltip')) return; // ê¸°ì¡´ P&C ë“±ì€ ìœ ì§€

    // (a) data-key ìš°ì„ 
    const key = a.getAttribute('data-key')?.trim();
    let tip = key && TOOLTIP_MAP[key];

    // (b) label í…ìŠ¤íŠ¸ë¡œë„ ì‹œë„
    if (!tip) {
      const label = a.querySelector('.label')?.textContent?.trim();
      if (label && TOOLTIP_MAP[label]) tip = TOOLTIP_MAP[label];
    }

    // (c) titleì´ ìˆìœ¼ë©´ ìŠ¹ê²©
    if (!tip && a.title) tip = a.title;

    if (tip) a.setAttribute('data-tooltip', tip);
  });
})();

  /* ===================== +N ë”ë³´ê¸° ì¹© + ëª¨ë‹¬ ===================== */
(function setupMoreChips(){
  const MAX_VISIBLE = 6; // ì¹´ë“œ ì•ˆì—ì„œ í•­ìƒ ë³´ì—¬ì¤„ ì•± ê°œìˆ˜(ì›í•˜ë©´ 8 ë“±ìœ¼ë¡œ ì¡°ì ˆ)

  const sections = document.querySelectorAll('#quick-grid > section .apps');
  sections.forEach(appsEl=>{
    const apps = [...appsEl.querySelectorAll('.app')];
    const hidden = apps.slice(MAX_VISIBLE);
    if(hidden.length === 0) return;

    // ìˆ¨ê¸¸ ê²ƒë“¤ ì ‘ê¸°
    hidden.forEach(a=>a.style.display='none');

    // +N ì¹© ì‚½ì…
    const chip = document.createElement('button');
    chip.type = 'button';
    chip.className = 'more-chip';
    chip.setAttribute('aria-haspopup', 'dialog');
    chip.innerHTML = `+${hidden.length} ë”ë³´ê¸°`;
    appsEl.appendChild(chip);

    // ì¹© í´ë¦­ â†’ ëª¨ë‹¬ì— í•´ë‹¹ ê·¸ë£¹ì˜ "ëª¨ë“  ì•±" ê·¸ë¦¬ë“œë¡œ ë Œë”
    chip.addEventListener('click', ()=>{
      const modal = document.getElementById('more-modal');
      const grid  = document.getElementById('more-grid');
      const title = document.getElementById('more-title');

      // ê·¸ë£¹ ìº¡ì…˜(ë°”ë¡œ ì•„ë˜ folder-labelì˜ í…ìŠ¤íŠ¸) ì½ê¸°
      const groupLabel = appsEl.closest('section')?.querySelector('.folder-label span')?.textContent?.trim() || 'ì•± ëª©ë¡';
      title.textContent = groupLabel;

      grid.innerHTML = '';
      apps.forEach(a=>{
        const card = document.createElement('a');
        card.className = 'more-app';
        card.href = a.href || '#';
        card.target = a.target || '_blank';
        if(a.rel) card.rel = a.rel;

        // ë°°ì§€/ë¼ë²¨ ë³µì œ
        const b = a.querySelector('.badge')?.cloneNode(true);
        const l = a.querySelector('.label')?.cloneNode(true);
        if(b) card.appendChild(b);
        if(l) card.appendChild(l);

        grid.appendChild(card);
      });

      // ëª¨ë‹¬ í‘œì‹œ
      modal.setAttribute('aria-hidden','false');
      modal.style.display='flex';
      document.body.style.overflow='hidden';
      document.getElementById('more-close').focus();
    });
  });

  // ëª¨ë‹¬ ë‹«ê¸°
  const m = document.getElementById('more-modal');
  const close = ()=>{ m.setAttribute('aria-hidden','true'); m.style.display='none'; document.body.style.overflow=''; };
  document.getElementById('more-close').addEventListener('click', close);
  m.addEventListener('click', e=>{ if(e.target.id === 'more-modal') close(); });
  document.addEventListener('keydown', e=>{ if(m.getAttribute('aria-hidden')==='false' && e.key==='Escape') close(); });
})();

  
</script>
</body>
</html>










