<!DOCTYPE html>
<html lang="ko" dir="ltr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="color-scheme" content="light" />
<title>ì‚¬ë‚´ í¬í„¸ â€“ ë°”ë¡œê°€ê¸° + ì „ì‚¬ì¼ì •</title>
<style>
  :root{
    --bg:#f6f7f9; --folder:#ffffff; --line:rgba(0,0,0,.06); --card:#fff; --grid:#e5e7eb; --text:#0f172a;
    --focus:#2563eb; --muted:#64748b; --shadow:0 12px 24px rgba(0,0,0,.06);
    --lane-h:64px; --lane-gap:1px; --left-col:160px; --header-h:34px; --cell-pad:8px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:24px; font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif; background:var(--bg); color:var(--text)}
  img{max-width:100%; display:block}
  a{color:inherit; text-decoration:none}
  a:focus-visible,button:focus-visible{outline:3px solid var(--focus); outline-offset:3px; border-radius:8px}
  .visually-hidden{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0}

  h1{margin:0 0 20px; font-size:18px}
  h2{margin:28px 0 12px; font-size:16px}
  .container{max-width:1200px; margin:0 auto}
  .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:24px}

  /* í´ë” ì¹´ë“œ */
  .folder{background:var(--folder);border-radius:28px;padding:18px 16px;border:1px solid var(--line);
          box-shadow:var(--shadow), inset 0 1px 0 rgba(255,255,255,.7); transition:transform .15s, box-shadow .15s}
  .folder:hover{ transform:translateY(-2px); box-shadow:0 16px 30px rgba(0,0,0,.08), inset 0 1px 0 rgba(255,255,255,.7) }
  .apps{display:grid; grid-template-columns:repeat(3,1fr); gap:10px}
  .app{display:flex; align-items:center; justify-content:center; flex-direction:column; color:var(--text); gap:6px; min-height:92px}
  .badge{width:58px;height:58px;border-radius:16px;display:flex;align-items:center;justify-content:center;box-shadow:inset 0 1px 0 rgba(255,255,255,.25), 0 6px 14px rgba(0,0,0,.08);transition:transform .12s, box-shadow .12s; font-weight:700; font-size:12px; color:#fff}
  .app:hover .badge{ transform:translateY(-1px); box-shadow:inset 0 1px 0 rgba(255,255,255,.25), 0 10px 18px rgba(0,0,0,.12) }
  .label{font-size:10px;color:#334155;text-align:center;max-width:84px;line-height:1.2}
  .c-red{background:linear-gradient(135deg,#ff6a7a,#ff3d3d)}
  .c-purple{background:linear-gradient(135deg,#a77bff,#7a4cff)}
  .c-sky{background:linear-gradient(135deg,#79b6ff,#4a8dff)}
  .c-orange{background:linear-gradient(135deg,#ffa552,#ff7a1a)}
  .c-green{background:linear-gradient(135deg,#55d6a9,#26b87a)}
  .c-blue{background:linear-gradient(135deg,#6e8cff,#3b5bff)}
  .c-teal{background:linear-gradient(135deg,#64e0e3,#28c3d6)}
  .c-gray{background:linear-gradient(135deg,#c9ced6,#9aa3ad)}
  .folder-label{display:flex;align-items:center;justify-content:center;gap:6px;margin-top:8px;font-size:14px}
  .folder-label .emoji{display:none !important;} /* ì´ëª¨ì§€ ì œê±° */

  /* ì¹´ë“œ */
  .card{background:var(--card);border:1px solid var(--grid);border-radius:14px;box-shadow:0 2px 6px rgba(0,0,0,.04)}

  /* ì»¨íŠ¸ë¡¤ */
  .controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin:10px 0 6px}
  .seg{display:inline-flex;border:1px solid var(--grid);border-radius:10px;overflow:hidden}
  .seg button{padding:6px 10px;border:0;background:#fff;font-size:12px;cursor:pointer}
  .seg button[aria-pressed="true"]{background:#eef2ff}
  .pill{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--grid);border-radius:999px;padding:6px 10px;background:#fff;font-size:12px;cursor:pointer}
  .pill[aria-pressed="true"]{background:#dcfce7}
  .scroll-x{display:flex;gap:8px;overflow:auto;padding-bottom:2px}

  /* ìº˜ë¦°ë” ìƒë‹¨ (Hero) */
  .sp-hero{margin:28px 0 8px}
  .sp-breadcrumb{font-size:12px;color:#6b7280;display:flex;gap:8px;align-items:center}
  .sp-breadcrumb .sep{opacity:.5}
  .sp-titlebar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:6px}
  .sp-titlebar h2{margin:0;font-size:22px}
  .sp-sub{margin:6px 0 0;color:#64748b;font-size:13px}
  .btn{border:1px solid var(--grid);background:#fff;border-radius:10px;padding:8px 12px;font-size:13px;cursor:pointer}
  .btn.ghost{background:#fafafa}
  .btn.primary{background:#2563eb;color:#fff;border-color:#2563eb}
  .btn[aria-pressed="true"]{box-shadow:inset 0 0 0 2px #2563eb33}

  /* ==== ì œëª© ë¼ì¸ë§Œ í•˜ì´ë¼ì´íŠ¸ ==== */
  .title-strip{
    display:flex; align-items:center; justify-content:space-between;
    padding:20px 18px; margin:0 0 14px; border-radius:14px; color:#fff;
    box-shadow:0 8px 20px rgba(17,38,94,.18);
    background:linear-gradient(135deg,#2a5eec,#6a8ef2);
  }
  .title-strip .btn.ghost{background:rgba(255,255,255,.16); color:#fff; border-color:transparent}
  .title-strip .btn.ghost:hover{background:rgba(255,255,255,.24)}

  /* ì—°ê°„ ë§¤íŠ¸ë¦­ìŠ¤ */
  .year-grid{position:relative;overflow:hidden}
  .header,.row{display:grid;grid-template-columns:var(--left-col) repeat(12,1fr)}
  .header div,.row div{padding:var(--cell-pad);border-bottom:1px solid var(--grid)}
  .header{background:#f7f8fa;font-size:12px;font-weight:600;position:sticky;top:0;z-index:2}
  .lane-name{padding:10px 12px;border-right:1px solid var(--grid);display:flex;align-items:center;font-size:12px;font-weight:600;background:#f9fafb;color:#111827}
  .cell{height:var(--lane-h);border-left:1px solid var(--grid)}
  .row .cell:first-child{border-left:none}
  .grid-lines{position:absolute;inset:var(--header-h) 0 0 var(--left-col);display:grid;grid-template-columns:repeat(12,1fr);pointer-events:none}
  .grid-lines div{border-left:1px dashed #e6e6e6}
  .bar-layer{position:absolute;inset:var(--header-h) 0 0 var(--left-col)}
  .event{position:absolute;height:26px;border-radius:8px;padding:4px 8px;font-size:12px;line-height:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:pointer;box-shadow:0 1px 3px rgba(0,0,0,.08);border:1px solid rgba(0,0,0,.05);font-weight:600}
  .t-ëŒ€í‘œì‹¤{background:#e0f2fe}.t-ì „ëµ{background:#d1fae5}.t-ì¬ê²½{background:#fef9c3}.t-P&C{background:#fee2e2}.t-IT{background:#e5e7eb}
  .t-ë¯¸ì…˜{background:#f5e8ff}.t-êµíŒŒ{background:#e7fff2}.t-êµë¯¸{background:#fff0e5}.t-ë¹„ì „{background:#ffe7fb}.t-ë¬´ë¸Œ{background:#e0e7ff}
  .today-line{position:absolute;top:var(--header-h);bottom:0;width:2px;background:#2563eb33;pointer-events:none}

  /* ì ‘ê·¼ì„± */
  @media (prefers-reduced-motion: reduce){
    .folder,.badge{transition:none}
  }
  @media print{
    body{margin:0}
    .grid,.imgbox,.hint,h1,.controls,.sp-hero{display:none}
    .year-grid{border:0}
  }
</style>
</head>
<body>
<div class="container" role="main">

  <!-- ì œëª© í•œ ì¤„ë§Œ í•˜ì´ë¼ì´íŠ¸ -->
  <h1 class="title-strip">
    <span>ë°”ë¡œê°€ê¸°</span>
    <button id="app-links-btn" class="btn ghost" type="button">ì•± ë§í¬</button>
  </h1>

  <!-- ì¹´í…Œê³ ë¦¬ ê·¸ë¦¬ë“œ -->
  <div class="grid" id="quick-grid">
    <!-- ğŸ¬ í˜„í™© -->
    <section aria-labelledby="sec-Dashboard">
      <div class="folder" role="group" aria-labelledby="sec-Dashboard">
        <div class="apps">
          <a class="app" data-key="CDSP" href="https://compassionkorea.lightning.force.com/lightning/r/Dashboard/01Z2x00000086p2EAA/view?queryScope=userFolders" target="_blank" rel="noopener noreferrer"><div class="badge c-purple">CDSP</div><div class="label">CDSP</div></a>
          <a class="app" data-key="KRI" href="https://compassionkorea.lightning.force.com/lightning/r/Dashboard/01Z2x000000QEwMEAW/view" target="_blank" rel="noopener noreferrer"><div class="badge c-red">KRI</div><div class="label">KRI</div></a>
          <a class="app" data-key="LE" href="https://compassionkorea.sharepoint.com/:x:/s/maketing/EXVOhXaIRMNBvzScNMHEycMBXkXIgNO1UNBRMcdAStnOWQ?e=4EfFYq" target="_blank" rel="noopener noreferrer"><div class="badge c-blue">LE</div><div class="label">LE</div></a>
          <a class="app" data-key="Scorecard" href="https://one.compassion.com/sites/finance/SitePageModern/194296/global-scorecard" target="_blank" rel="noopener noreferrer"><div class="badge c-green">GS</div><div class="label">Global Scorecard</div></a>
          <span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-dashboard"><span>í˜„í™©</span></div>
    </section>

    <!-- â¤ï¸ P&C -->
    <section aria-labelledby="sec-pc">
      <div class="folder" role="group" aria-labelledby="sec-pc">
        <div class="apps">
          <a class="app" data-key="ì¸ì‚¬ê·¼íƒœ" href="http://gwa.compassion.or.kr/gw/bizbox.do" target="_blank" rel="noopener noreferrer" title="ì¸ì‚¬ê·¼íƒœ">
            <div class="badge c-red"><span aria-hidden="true">ê·¼íƒœ</span></div><div class="label">ì¸ì‚¬ê·¼íƒœ</div>
          </a>
          <a class="app" data-key="ì¡°ì§ë„" href="https://compassionkorea.sharepoint.com/:b:/s/share/EVwEjJlrN2JGs9_tak31NVABfFJgdYNMhtQGLq0ArpJZNA?e=HZ27fL" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">OC</div><div class="label">ì¡°ì§ë„</div></a>
          <a class="app" data-key="ì—°ë½ì²˜" href="https://compassionkorea.sharepoint.com/:b:/s/share/EW4HfbQ0aUdEsSm7fBLWAHMBbWviKQ6R6FUxvvXu7P3k7Q?e=padbKz" target="_blank" rel="noopener noreferrer"><div class="badge c-purple">ì—°ë½</div><div class="label">ì—°ë½ì²˜</div></a>
          <a class="app" data-key="ì‚¬ë²ˆ" href="#" target="_blank" rel="noopener noreferrer"><div class="badge c-orange">ID</div><div class="label">ì‚¬ë²ˆ</div></a>
          <a class="app" data-key="LMS êµìœ¡" href="https://hrd.compassion.or.kr/index.do" target="_blank" rel="noopener noreferrer"><div class="badge c-green">LMS</div><div class="label">LMS êµìœ¡</div></a>
          <span></span><span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-pc"><span>P&amp;C</span></div>
    </section>

    <!-- ğŸ‘ ì¬ê²½ -->
    <section aria-labelledby="sec-fin">
      <div class="folder" role="group" aria-labelledby="sec-fin">
        <div class="apps">
          <a class="app" data-key="ê·¸ë£¹ì›¨ì–´" href="http://gwa.compassion.or.kr/gw/userMain.do" target="_blank" rel="noopener noreferrer"><div class="badge c-green">GW</div><div class="label">ê·¸ë£¹ì›¨ì–´</div></a>
          <a class="app" data-key="Bizplay" href="https://www.bizplay.co.kr/main_0003_01.act" target="_blank" rel="noopener noreferrer"><div class="badge c-orange">ë¹„í”Œ</div><div class="label">Bizplay</div></a>
          <a class="app" data-key="Chat FIN" href="https://handy-reply-c1d.notion.site/ChatFIN-5b4bfe383a864a658cd59dd7de0bc671" target="_blank" rel="noopener noreferrer"><div class="badge c-teal">FIN</div><div class="label">Chat FIN</div></a>
          <span></span><span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-fin"><span>ì¬ê²½</span></div>
    </section>

    <!-- âœ” ì‹ ì²­/ì ‘ìˆ˜ -->
    <section aria-labelledby="sec-apply">
      <div class="folder" role="group" aria-labelledby="sec-apply">
        <div class="apps">
          <a class="app" data-key="Blue line" href="https://docs.google.com/forms/d/1SyKV9_o6ctBeClGW8wDpPnGf94RvEZqWaYfZ9e6cgxg/viewform?edit_requested=true" target="_blank" rel="noopener noreferrer"><div class="badge c-blue">BL</div><div class="label">Blue line</div></a>
          <a class="app" data-key="CS" href="https://compassionkorea-my.sharepoint.com/:x:/g/personal/dalim_compassion_or_kr/EQ_Gs9DNgN9PiUWxnUlVemoB07hunygEASEHkVd9av4EOQ?e=wvJixF" target="_blank" rel="noopener noreferrer"><div class="badge c-orange">CS</div><div class="label">CSì‹ ì²­</div></a>
          <a class="app" data-key="L&L" href="https://forms.office.com/r/TtTWjVKUGt" target="_blank" rel="noopener noreferrer"><div class="badge c-teal">L&L</div><div class="label">LUNCH & LEARN</div></a>
          <a class="app" data-key="IT HELP" href="https://compassionkorea.lightning.force.com/lightning/o/ITServiceRequest__c/home" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">IT</div><div class="label">IT HELP</div></a>
          <a class="app" data-key="OA ì„œë¹„ìŠ¤" href="https://forms.office.com/pages/responsepage.aspx?id=F3AWrGQVgEyEyvVroUgajahITEsIIu5IoQ0dkMJU9PRUQ0hNSjY3NEtQWTJPWktSTzZVSE04OFE2SCQlQCN0PWcu&route=shorturl" target="_blank" rel="noopener noreferrer"><div class="badge c-purple">OA</div><div class="label">OA ì„œë¹„ìŠ¤</div></a>
          <a class="app" data-key="ì—…ë¬´ìš”ì²­" href="https://compassionkorea.sharepoint.com/sites/request" target="_blank" rel="noopener noreferrer"><div class="badge c-green">ìš”ì²­</div><div class="label">ì—…ë¬´ìš”ì²­</div></a>
          <span></span><span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-apply"><span>ì‹ ì²­/ì ‘ìˆ˜</span></div>
    </section>

    <!-- ğŸ¬ ë¸Œëœë”© -->
    <section aria-labelledby="sec-brand">
      <div class="folder" role="group" aria-labelledby="sec-brand">
        <div class="apps">
          <a class="app" data-key="ë¸Œëœë“œ í—ˆë¸Œ" href="https://compassionkorea.sharepoint.com/sites/BrandHub" target="_blank" rel="noopener noreferrer"><div class="badge c-purple">í—ˆë¸Œ</div><div class="label">ë¸Œëœë“œ í—ˆë¸Œ</div></a>
          <a class="app" data-key="ìœ íŠœë¸Œ" href="https://www.youtube.com/@CompassionKR" target="_blank" rel="noopener noreferrer"><div class="badge c-red">YouTube</div><div class="label">ìœ íŠœë¸Œ</div></a>
          <a class="app" data-key="ìˆì¸ " href="https://www.youtube.com/@CompassionKR/shorts" target="_blank" rel="noopener noreferrer"><div class="badge c-blue">ìˆì¸ </div><div class="label">ìˆì¸ </div></a>
          <a class="app" data-key="ë„¤ì´ë²„ í¬ìŠ¤íŠ¸" href="https://blog.naver.com/prologue/PrologueList.naver?blogId=compassionkorea&skinType=&skinId=&from=menu&userSelectMenu=true" target="_blank" rel="noopener noreferrer"><div class="badge c-green">NAVER</div><div class="label">ë„¤ì´ë²„ í¬ìŠ¤íŠ¸</div></a>
          <span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-brand"><span>ë¸Œëœë”©</span></div>
    </section>

    <!-- ğŸ’œ Website -->
    <section aria-labelledby="sec-web">
      <div class="folder" role="group" aria-labelledby="sec-web">
        <div class="apps">
          <a class="app" data-key="ê¸€ë¡œë²Œ ONE" href="https://one.compassion.com" target="_blank" rel="noopener noreferrer"><div class="badge c-teal">ONE</div><div class="label">ê¸€ë¡œë²Œ ONE</div></a>
          <a class="app" data-key="CSF" href="https://compassionkorea.lightning.force.com/lightning/page/home" target="_blank" rel="noopener noreferrer"><div class="badge c-gray">CSF</div><div class="label">CSF</div></a>
          <a class="app" data-key="í™ˆí˜ì´ì§€" href="https://www.compassion.or.kr/" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">CK</div><div class="label">í•œêµ­ì»´íŒ¨ì…˜</div></a>
          <a class="app" data-key="US" href="http://www.compassion.com/" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">US</div><div class="label">ì»´íŒ¨ì…˜ US</div></a>
          <a class="app" data-key="AU" href="https://www.compassion.com.au/" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">AU</div><div class="label">ì»´íŒ¨ì…˜ AU</div></a>
          <a class="app" data-key="UK" href="https://www.compassionuk.org/" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">UK</div><div class="label">ì»´íŒ¨ì…˜ UK</div></a>
          <a class="app" data-key="CA" href="https://www.compassion.ca/" target="_blank" rel="noopener noreferrer"><div class="badge c-sky">CA</div><div class="label">ì»´íŒ¨ì…˜ CA</div></a>
          <span></span><span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-web"><span>Website</span></div>
    </section>

    <!-- ğŸ§© íƒ€ê¸°ê´€ -->
    <section aria-labelledby="sec-ngo">
      <div class="folder" role="group" aria-labelledby="sec-ngo">
        <div class="apps">
          <a class="app" data-key="ì›”ë“œë¹„ì „" href="https://www.worldvision.or.kr/" target="_blank" rel="noopener noreferrer" title="ì›”ë“œë¹„ì „"><div class="badge c-orange">WV</div><div class="label">ì›”ë“œë¹„ì „</div></a>
          <a class="app" data-key="ìœ ë‹ˆì„¸í”„" href="https://www.unicef.or.kr/" target="_blank" rel="noopener noreferrer" title="ìœ ë‹ˆì„¸í”„"><div class="badge c-sky">UNICEF</div><div class="label">ìœ ë‹ˆì„¸í”„</div></a>
          <a class="app" data-key="êµ¿ë„¤ì´ë²„ìŠ¤" href="https://www.goodneighbors.kr/" target="_blank" rel="noopener noreferrer" title="êµ¿ë„¤ì´ë²„ìŠ¤"><div class="badge c-green">GN</div><div class="label">êµ¿ë„¤ì´ë²„ìŠ¤</div></a>
          <a class="app" data-key="ì„¸ì´ë¸Œë”ì¹ ë“œëŸ°" href="https://www.sc.or.kr/" target="_blank" rel="noopener noreferrer" title="ì„¸ì´ë¸Œë”ì¹ ë“œëŸ°"><div class="badge c-red">SC</div><div class="label">ì„¸ì´ë¸Œ</div></a>
          <a class="app" data-key="ê¸°ì•„ëŒ€ì±…" href="https://www.kfhi.or.kr/" target="_blank" rel="noopener noreferrer" title="ê¸°ì•„ëŒ€ì±…"><div class="badge c-purple">KFHI</div><div class="label">ê¸°ì•„ëŒ€ì±…</div></a>
          <a class="app" data-key="ì´ˆë¡ìš°ì‚°" href="https://www.childfund.or.kr/main.do" target="_blank" rel="noopener noreferrer" title="ì´ˆë¡ìš°ì‚° ì–´ë¦°ì´ì¬ë‹¨"><div class="badge c-teal">CF</div><div class="label">ì´ˆë¡ìš°ì‚°</div></a>
          <a class="app" data-key="ë°€ì•Œ" href="https://miral.org/main/main.asp" target="_blank" rel="noopener noreferrer" title="ë°€ì•Œ ë³µì§€ì¬ë‹¨"><div class="badge c-gray">ë°€ì•Œ</div><div class="label">ë°€ì•Œ</div></a>
          <span></span><span></span>
        </div>
      </div>
      <div class="folder-label" id="sec-ngo"><span>íƒ€ê¸°ê´€</span></div>
    </section>
  </div>

  <!-- ====================== ì „ì‚¬ì¼ì •&í–‰ì‚¬ ====================== -->
  <section class="sp-hero" aria-labelledby="ecal-title">
    <div class="sp-breadcrumb" aria-label="breadcrumb">
      <span>About Us</span> <span class="sep">/</span>
      <span>Enterprise Calendar</span>
    </div>
    <div class="sp-titlebar">
      <h2 id="ecal-title">Enterprise Calendar</h2>
      <div class="sp-actions" role="toolbar" aria-label="Calendar actions">
        <button type="button" class="btn ghost" id="btn-compact" aria-pressed="false" title="ë°€ì§‘ ë³´ê¸°">Compact</button>
        <button type="button" class="btn" id="btn-export" title="CSVë¡œ ë‚´ë³´ë‚´ê¸°">Export</button>
        <a class="btn primary" id="btn-add" href="event-admin.html" title="ì¼ì • ì¶”ê°€">Add Event</a>
      </div>
    </div>
    <p class="sp-sub">ì „ì‚¬ ì¼ì •ê³¼ ì£¼ìš” í–‰ì‚¬ ì¼ì •ì„ ì›” ë‹¨ìœ„ë¡œ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”.</p>
  </section>

  <!-- ìº˜ë¦°ë” ìŠ¤ëƒ…ìƒ·(ì„ íƒ) -->
  <div class="card imgbox" aria-label="ì „ì‚¬ ì¼ì • ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°">
    <img id="calendar-thumb" src="enterprise-calendar.png" alt="Enterprise Calendar" loading="lazy" onclick="openImage()" onload="calendarImageReady()" onerror="calendarImageMissing()" />
  </div>

  <!-- ë³´ê¸° ì „í™˜ & í•„í„° -->
  <div class="controls" aria-label="ë³´ê¸° ë° í•„í„°">
    <div class="seg" role="tablist" aria-label="ë³´ê¸° ì „í™˜">
      <button id="btn-view-cat" role="tab" aria-selected="true" aria-pressed="true">ì¹´í…Œê³ ë¦¬ë³„</button>
      <button id="btn-view-team" role="tab" aria-selected="false" aria-pressed="false">íŒ€ë³„</button>
    </div>
    <div id="filter-cat" class="scroll-x" aria-label="ì¹´í…Œê³ ë¦¬ ì„ íƒ"></div>
    <div id="filter-team" class="scroll-x" aria-label="íŒ€ ì„ íƒ" style="display:none"></div>
  </div>

  <!-- ì—°ê°„ ë§¤íŠ¸ë¦­ìŠ¤ -->
  <div class="card year-grid" style="margin-top:8px" id="year-grid" aria-labelledby="year-title">
    <div id="year-title" class="visually-hidden" aria-hidden="true">ì—°ê°„ ì¼ì • ë§¤íŠ¸ë¦­ìŠ¤</div>
    <div class="header">
      <div style="border-right:1px solid var(--grid)"></div>
      <div>1ì›”</div><div>2ì›”</div><div>3ì›”</div><div>4ì›”</div><div>5ì›”</div><div>6ì›”</div>
      <div>7ì›”</div><div>8ì›”</div><div>9ì›”</div><div>10ì›”</div><div>11ì›”</div><div>12ì›”</div>
    </div>
    <div id="lane-rows"></div>
    <div class="grid-lines" aria-hidden="true">
      <div></div><div></div><div></div><div></div><div></div><div></div>
      <div></div><div></div><div></div><div></div><div></div><div></div>
    </div>
    <div class="today-line" id="today-line" aria-hidden="true"></div>
    <div class="bar-layer" id="bar-layer"></div>
  </div>
  <p class="hint">â€» <code>events</code>ì™€ ì•± ë§í¬ëŠ” ë¸Œë¼ìš°ì € ë¡œì»¬ì— ì €ì¥ë©ë‹ˆë‹¤.</p>
</div>

<!-- ì•± ë§í¬ í¸ì§‘ ëª¨ë‹¬ -->
<div id="app-links-modal" aria-hidden="true" role="dialog" aria-modal="true"
     style="position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:20px;z-index:60">
  <div style="background:#fff;border:1px solid var(--grid);border-radius:14px;max-width:720px;width:100%;padding:16px">
    <h3 style="margin:0 0 8px">ì•± ë§í¬ ë¶™ì—¬ë„£ê¸°</h3>
    <p class="muted" style="margin:0 0 8px">
      í˜•ì‹: <code>key,url</code> â€” ì˜ˆ) <code>ì¡°ì§ë„,https://...</code>
    </p>
    <textarea id="app-links-text" style="width:100%;height:200px;border:1px solid var(--grid);border-radius:10px;padding:8px"
      placeholder="key,url&#10;ì¡°ì§ë„,https://..."></textarea>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
      <button id="app-links-cancel" class="btn" type="button">ì·¨ì†Œ</button>
      <button id="app-links-apply" class="btn primary" type="button">ì ìš©</button>
    </div>
  </div>
</div>

<!-- ê³µìš© ëª¨ë‹¬(ìº˜ë¦°ë” ì´ë¯¸ì§€ ë³´ê¸°) -->
<div id="modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="m-title" aria-describedby="m-when m-dept m-note" style="display:none;align-items:center;justify-content:center;position:fixed;inset:0;background:rgba(0,0,0,.45);padding:20px">
  <div class="box" style="background:#fff;border-radius:14px;padding:18px;max-width:560px;width:100%;border:1px solid var(--grid);box-shadow:0 10px 30px rgba(0,0,0,.15)">
    <h3 id="m-title" style="margin:0 0 8px;font-size:16px"></h3>
    <p id="m-when" style="margin:6px 0 0;font-size:13px;color:#334155;white-space:pre-line"></p>
    <p id="m-dept" style="margin:6px 0 0;font-size:13px;color:#334155;white-space:pre-line"></p>
    <p id="m-note" style="margin:6px 0 0;font-size:13px;color:#334155;white-space:pre-line"></p>
    <div class="modal-actions" style="display:flex;justify-content:flex-end;gap:8px;margin-top:16px"><button class="close btn" id="closeBtn">ë‹«ê¸° (Esc)</button></div>
  </div>
</div>

<script>
  /* ---------- ì „ì‚¬ì¼ì • ---------- */
  const CATEGORIES=["í–‰ì‚¬","ì—…ë¬´","ì‹ ì²­"];
  const LANES=["ëŒ€í‘œì‹¤","ì „ëµ","ì¬ê²½","P&C","IT","ë¯¸ì…˜","êµíŒŒ","êµë¯¸","ë¹„ì „","ë¬´ë¸Œ"];
  const LS_KEY='gate:events:v1';
  const $=(s)=>document.querySelector(s);
  const KST=new Intl.DateTimeFormat('ko-KR',{timeZone:'Asia/Seoul',dateStyle:'medium'});
  const fmtRange=(s,e)=>`${KST.format(s)} ~ ${KST.format(e)}`;
  const parseDate=(s)=>{const [y,m,d]=s.split('-').map(Number);return new Date(y,m-1,d);};

  // ë ˆì¸ í–‰ ë§Œë“¤ê¸°
  const laneRows=$("#lane-rows");
  LANES.forEach(name=>{
    const row=document.createElement("div");
    row.className="row";
    row.innerHTML=`<div class="lane-name">${name}</div>`+Array.from({length:12}).map(()=>`<div class="cell"></div>`).join("");
    laneRows.appendChild(row);
  });

  // í•„í„°
  const catWrap=$("#filter-cat"), teamWrap=$("#filter-team");
  let activeCategory='ì „ì²´', activeTeam='ì „ì²´';
  function renderFilterPills(){
    catWrap.innerHTML='';
    ["ì „ì²´",...CATEGORIES].forEach(cat=>{
      const b=document.createElement('button');
      b.className='pill'; b.type='button'; b.textContent=cat;
      b.setAttribute('aria-pressed', String(activeCategory===cat));
      b.onclick=()=>{activeCategory=cat;refresh();renderFilterPills();};
      catWrap.appendChild(b);
    });
    teamWrap.innerHTML='';
    ["ì „ì²´",...LANES].forEach(team=>{
      const b=document.createElement('button');
      b.className='pill'; b.type='button'; b.textContent=team;
      b.setAttribute('aria-pressed', String(activeTeam===team));
      b.onclick=()=>{activeTeam=team;refresh();renderFilterPills();};
      teamWrap.appendChild(b);
    });
  }
  document.getElementById('btn-view-cat').onclick=()=>{catWrap.style.display='flex';teamWrap.style.display='none';};
  document.getElementById('btn-view-team').onclick=()=>{catWrap.style.display='none';teamWrap.style.display='flex';};

  // ê¸°ë³¸ ì´ë²¤íŠ¸ (ë¡œì»¬ ì €ì¥ ìš°ì„ )
  const DEFAULT_EVENTS=[
    { title:"Global Budget", start:"2025-02-10", end:"2025-03-20", lane:"ì „ëµ", category:"ì—…ë¬´", note:"PGS~PGS" },
    { title:"Global Connection", start:"2025-03-01", end:"2025-03-31", lane:"ì „ëµ", category:"í–‰ì‚¬", note:"ì „ì‚¬ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜" },
    { title:"Mission Update", start:"2025-05-01", end:"2025-05-31", lane:"ë¯¸ì…˜", category:"í–‰ì‚¬", note:"ë¯¸ì…˜ ë¦¬í”„ë ˆì‹œ" },
    { title:"H1 Forecast ì •ë¦¬", start:"2025-04-01", end:"2025-04-30", lane:"ì¬ê²½", category:"ì—…ë¬´", note:"ìƒë°˜ê¸° FCST" },
    { title:"H2 Forecast ì¤€ë¹„", start:"2025-09-01", end:"2025-09-30", lane:"ì¬ê²½", category:"ì—…ë¬´", note:"í•˜ë°˜ê¸° FCST" },
    { title:"Performance Review(H1)", start:"2025-06-01", end:"2025-06-30", lane:"P&C", category:"ì—…ë¬´", note:"í‰ê°€/ë³´ìƒ" },
    { title:"Leadership Day", start:"2025-10-01", end:"2025-10-07", lane:"P&C", category:"í–‰ì‚¬", note:"ë¦¬ë”ì‹­ ì›Œí¬ìƒµ" },
    { title:"ë³´ì•ˆ/ì •ì±… ì ê²€", start:"2025-07-01", end:"2025-07-31", lane:"IT", category:"ì—…ë¬´", note:"ì •ê¸° ì ê²€" },
    { title:"ì‚¬ë‚´ êµìœ¡ ìœ„í¬", start:"2025-04-07", end:"2025-04-11", lane:"ë¹„ì „", category:"ì‹ ì²­", note:"ì§ë¬´/ê¸°ìˆ  êµìœ¡ (ì‚¬ì „ ì‹ ì²­)" },
    { title:"ì‹ ì œí’ˆ ë¡ ì¹­ ìº í˜ì¸", start:"2025-06-01", end:"2025-07-15", lane:"êµë¯¸", category:"ì—…ë¬´", note:"ë©€í‹°ì±„ë„" },
    { title:"ê³ ê° ì»¨í¼ëŸ°ìŠ¤", start:"2025-11-10", end:"2025-11-12", lane:"ë¬´ë¸Œ", category:"í–‰ì‚¬", note:"ì£¼ìš” ê³ ê° ì´ˆì²­" }
  ];
  function loadEvents(){try{const s=localStorage.getItem(LS_KEY);return s?JSON.parse(s):DEFAULT_EVENTS;}catch(e){return DEFAULT_EVENTS;}}
  function saveEvents(list){localStorage.setItem(LS_KEY, JSON.stringify(list));}
  let events=loadEvents();

  // ë°” ë Œë”
  const layer=document.getElementById("bar-layer");
  const todayLine=document.getElementById("today-line");
  function monthIndex(d){return d.getMonth();}
  function monthSpan(s,e){const months=(e.getFullYear()-s.getFullYear())*12+(e.getMonth()-s.getMonth())+1;return Math.max(1,months);}
  function laneY(name){const idx=LANES.indexOf(name);const header=34;const laneH=parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--lane-h'));const gap=parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--lane-gap'));return header+idx*(laneH+gap);}
  function renderTodayLine(){const now=new Date();const m=now.getMonth();const d=now.getDate();const dim=new Date(now.getFullYear(),m+1,0).getDate();const frac=m+(d-1)/dim;const leftPct=(frac/12)*100;todayLine.style.left=`calc(${leftPct}% + var(--left-col))`;}
  function filtered(list){return list.filter(ev=>{const okCat=(activeCategory==='ì „ì²´')||(ev.category===activeCategory);const okTeam=(activeTeam==='ì „ì²´')||(ev.lane===activeTeam);return okCat&&okTeam;});}
  function renderBars(){
    layer.innerHTML='';
    filtered(events).forEach(ev=>{
      const s=parseDate(ev.start), e=parseDate(ev.end);
      const sIdx=monthIndex(s), span=monthSpan(s,e);
      const bar=document.createElement('div');
      bar.className=`event t-${ev.lane}`;
      bar.style.left=`calc(${(sIdx/12)*100}% + 6px)`;
      bar.style.top=`${laneY(ev.lane) + 18}px`;
      bar.style.width=`calc(${(span/12)*100}% - 12px)`;
      bar.setAttribute('role','button');
      bar.setAttribute('tabindex','0');
      bar.setAttribute('aria-label',`${ev.lane} Â· ${ev.title} Â· ${ev.start}~${ev.end} Â· ${ev.category}`);
      bar.textContent=ev.title;
      bar.addEventListener('click',()=>openModal(ev));
      bar.addEventListener('keydown',(e)=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();openModal(ev);}});
      layer.appendChild(bar);
    });
    renderTodayLine();
  }

  function openModal(ev){
    document.getElementById("m-title").textContent=ev.title;
    const s=parseDate(ev.start), e=parseDate(ev.end);
    document.getElementById("m-when").textContent=`ì¼ì •: ${fmtRange(s,e)}`;
    document.getElementById("m-dept").textContent=`íŒ€: ${ev.lane} Â· ì¹´í…Œê³ ë¦¬: ${ev.category}`;
    document.getElementById("m-note").textContent=ev.note ? `ë©”ëª¨: ${ev.note}` : '';
    const modal=document.getElementById("modal");
    modal.style.display='flex';
    modal.setAttribute('aria-hidden','false');
    document.body.style.overflow='hidden';
    document.getElementById("closeBtn").focus();
  }
  function closeModal(){
    const modal=document.getElementById("modal");
    modal.style.display='none';
    modal.setAttribute('aria-hidden','true');
    document.body.style.overflow='';
  }
  document.getElementById("modal").addEventListener('click', (e)=>{ if(e.target.id==='modal') closeModal(); });
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeModal(); });
  document.getElementById("closeBtn").addEventListener('click', closeModal);

  // ì´ˆê¸° ë Œë”
  function refresh(){ renderBars(); }
  renderFilterPills();
  refresh();
  window.addEventListener('resize', refresh);

  // Export / ì´ë¯¸ì§€ ë³´ê¸°
  document.getElementById('btn-export').addEventListener('click', ()=>{
    const headers=["title","start","end","lane","category","note"];
    const rows=[headers.join(",")].concat(
      events.map(ev=>headers.map(h=>{
        const val=(ev[h]??"").toString().replace(/"/g,'""');
        return /[",\n]/.test(val)?`"${val}"`:val;
      }).join(","))
    );
    const csv=rows.join("\n");
    const blob=new Blob([csv],{type:"text/csv;charset=utf-8;"});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');
    a.href=url; a.download='enterprise-calendar.csv';
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  });

  // ìº˜ë¦°ë” ì´ë¯¸ì§€ ë³´ê¸°
  let imageAvailable=false;
  function calendarImageReady(){ imageAvailable=true; }
  function calendarImageMissing(){ imageAvailable=false; document.querySelector('.imgbox')?.remove(); }
  function openImage(){
    if(!imageAvailable) return;
    document.getElementById("m-title").textContent='ì „ì‚¬ì¼ì •&í–‰ì‚¬ (ì´ë¯¸ì§€)';
    document.getElementById("m-when").innerHTML='<img src="enterprise-calendar.png" style="width:100%;border:1px solid #e5e7eb;border-radius:8px" alt="calendar" />';
    document.getElementById("m-dept").textContent='';
    document.getElementById("m-note").textContent='';
    document.getElementById("modal").style.display='flex';
    document.getElementById("modal").setAttribute('aria-hidden','false');
    document.body.style.overflow='hidden';
    document.getElementById("closeBtn").focus();
  }
  window.calendarImageReady=calendarImageReady;
  window.calendarImageMissing=calendarImageMissing;
  window.openImage=openImage;

  /* ---------- ìƒë‹¨ ì•± ë§í¬ ë§¤í•‘ (ë¡œì»¬ ì €ì¥) ---------- */
  const APP_LINKS_LS='portal:app_links:v2';
  const APP_KEYS=["ì¸ì‚¬ê·¼íƒœ","ì¡°ì§ë„","ì—°ë½ì²˜","ì‚¬ë²ˆ","LMS êµìœ¡","Blue line","ê·¸ë£¹ì›¨ì–´","Bizplay","Chat FIN",
                  "ë¸Œëœë“œ í—ˆë¸Œ","ìœ íŠœë¸Œ","ë„¤ì´ë²„ í¬ìŠ¤íŠ¸","ìˆì¸ ","ê¸€ë¡œë²Œ ONE","CSF","í™ˆí˜ì´ì§€","US","AU","UK","CA",
                  "ì›”ë“œë¹„ì „","ìœ ë‹ˆì„¸í”„","êµ¿ë„¤ì´ë²„ìŠ¤","ì„¸ì´ë¸Œë”ì¹ ë“œëŸ°","ê¸°ì•„ëŒ€ì±…","ì´ˆë¡ìš°ì‚°","ë°€ì•Œ","Scorecard","CDSP","KRI","LE","IT HELP","OA ì„œë¹„ìŠ¤","ì—…ë¬´ìš”ì²­","L&L","CS"];
  const APP_LINKS_DEFAULT={
    "ì¡°ì§ë„":"https://compassionkorea.sharepoint.com/:b:/s/share/EVwEjJlrN2JGs9_tak31NVABfFJgdYNMhtQGLq0ArpJZNA?e=bXsScl"
  };
  function loadAppLinks(){try{const s=localStorage.getItem(APP_LINKS_LS);return s?JSON.parse(s):{...APP_LINKS_DEFAULT};}catch(e){return {...APP_LINKS_DEFAULT};}}
  function saveAppLinks(map){localStorage.setItem(APP_LINKS_LS,JSON.stringify(map));}
  function applyAppLinks(){
    const map=loadAppLinks();
    document.querySelectorAll('.app[data-key]').forEach(a=>{
      const key=a.getAttribute('data-key'); const url=map[key];
      if(url){ a.href=url; a.target='_blank'; a.rel='noopener noreferrer'; a.title=(a.title||key)+' (ì—´ê¸°)'; }
    });
  }
  applyAppLinks();

  // ë§í¬ í¸ì§‘ ëª¨ë‹¬
  const $alb=document.getElementById('app-links-btn'),
        $alm=document.getElementById('app-links-modal'),
        $alt=document.getElementById('app-links-text'),
        $ala=document.getElementById('app-links-apply'),
        $alc=document.getElementById('app-links-cancel');
  function openAL(){
    $alm.style.display='flex';
    $alm.setAttribute('aria-hidden','false');
    const map=loadAppLinks();
    $alt.value='key,url\n'+APP_KEYS.map(k=>`${k},${map[k]||''}`).join('\n');
    $alt.focus();
  }
  function closeAL(){
    $alm.style.display='none';
    $alm.setAttribute('aria-hidden','true');
  }
  $alb.addEventListener('click',openAL);
  $alc.addEventListener('click',closeAL);
  $alm.addEventListener('click',e=>{ if(e.target.id==='app-links-modal') closeAL(); });
  document.addEventListener('keydown',e=>{ if(e.key==='Escape'&&$alm.style.display==='flex') closeAL(); });

  function parseLinksCSV(text){
    const rows=text.trim().split(/\r?\n/).map(r=>r.split(',').map(s=>s.trim()));
    if(rows.length && /^key$/i.test(rows[0][0])) rows.shift();
    const out={}; rows.forEach(([k,u])=>{ if(k) out[k]=u||'#'; });
    return out;
  }
  $ala.addEventListener('click',()=>{
    const parsed=parseLinksCSV($alt.value);
    if(!Object.keys(parsed).length){alert('ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');return;}
    const merged={...loadAppLinks(),...parsed};
    saveAppLinks(merged); applyAppLinks(); closeAL();
    alert('ì•± ë§í¬ê°€ ë°˜ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.');
  });
</script>
</body>
</html>
